<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Building a model of Parkinson&#39;s disease using Neural Mass models · Neuroblox</title><meta name="title" content="Building a model of Parkinson&#39;s disease using Neural Mass models · Neuroblox"/><meta property="og:title" content="Building a model of Parkinson&#39;s disease using Neural Mass models · Neuroblox"/><meta property="twitter:title" content="Building a model of Parkinson&#39;s disease using Neural Mass models · Neuroblox"/><meta name="description" content="Documentation for Neuroblox."/><meta property="og:description" content="Documentation for Neuroblox."/><meta property="twitter:description" content="Documentation for Neuroblox."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="Neuroblox logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Neuroblox</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Neuroblox</a></li><li><a class="tocitem" href="../../getting_started/">Getting Started</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../resting_state/">Resting state simulation using neural mass models</a></li><li class="is-active"><a class="tocitem" href>Building a model of Parkinson&#39;s disease using Neural Mass models</a><ul class="internal"><li><a class="tocitem" href="#The-Jansen-Rit-Neural-Mass-Model"><span>The Jansen-Rit Neural Mass Model</span></a></li><li><a class="tocitem" href="#Setting-Up-the-Model"><span>Setting Up the Model</span></a></li><li><a class="tocitem" href="#Building-the-Circuit"><span>Building the Circuit</span></a></li><li><a class="tocitem" href="#Creating-the-Model"><span>Creating the Model</span></a></li><li><a class="tocitem" href="#Simulating-the-Model"><span>Simulating the Model</span></a></li></ul></li><li><a class="tocitem" href="../neural_assembly/">Tutorial on bottom-up approach to building a neural assembly</a></li></ul></li><li><a class="tocitem" href="../../api/">API</a></li><li><a class="tocitem" href="../../release_notes/">Release Notes</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Building a model of Parkinson&#39;s disease using Neural Mass models</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Building a model of Parkinson&#39;s disease using Neural Mass models</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Neuroblox/Neuroblox.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Neuroblox/Neuroblox.jl/blob/master/docs/src/tutorials/parkinsons.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Building-a-model-of-Parkinson&#39;s-disease-using-Neural-Mass-models"><a class="docs-heading-anchor" href="#Building-a-model-of-Parkinson&#39;s-disease-using-Neural-Mass-models">Building a model of Parkinson&#39;s disease using Neural Mass models</a><a id="Building-a-model-of-Parkinson&#39;s-disease-using-Neural-Mass-models-1"></a><a class="docs-heading-anchor-permalink" href="#Building-a-model-of-Parkinson&#39;s-disease-using-Neural-Mass-models" title="Permalink"></a></h1><p>In this example, we&#39;ll construct a model of Parkinson&#39;s disease using eight Jansen-Rit Neural Mass Models, based on the work of Liu et al. (2020) [1].</p><h2 id="The-Jansen-Rit-Neural-Mass-Model"><a class="docs-heading-anchor" href="#The-Jansen-Rit-Neural-Mass-Model">The Jansen-Rit Neural Mass Model</a><a id="The-Jansen-Rit-Neural-Mass-Model-1"></a><a class="docs-heading-anchor-permalink" href="#The-Jansen-Rit-Neural-Mass-Model" title="Permalink"></a></h2><p>The Jansen-Rit model [2] is another popular neural mass model that, like the Wilson-Cowan model from <a href="#example-1-creating-a-simple-neural-circuit">Example 1</a>, describes the average activity of neural populations. Each Jansen-Rit unit is defined by the following differential equations:</p><p class="math-container">\[\begin{align}
\frac{dx}{dt} &amp;= y-\frac{2}{\tau}x \\[10pt]
\frac{dy}{dt} &amp;= -\frac{x}{\tau^2} + \frac{H}{\tau} \left[2\lambda S(\textstyle\sum{jcn}) - \lambda\right]
\end{align}\]</p><p>where <span>$x$</span> represents the average postsynaptic membrane potential of the neural population, <span>$y$</span> is an auxiliary variable, <span>$\tau$</span> is the membrane time constant, <span>$H$</span> is the maximum postsynaptic potential amplitude, <span>$\lambda$</span> determines the maximum firing rate, and <span>$\sum{jcn}$</span> represents the sum of all synaptic inputs to the population. The sigmoid function <span>$S(x)$</span> models the population&#39;s firing rate response to input and is defined as:</p><p class="math-container">\[S(x) = \frac{1}{1 + \text{exp}(-rx)}\]</p><p>where <span>$r$</span> controls the steepness of the sigmoid, affecting the population&#39;s sensitivity to input.</p><h2 id="Setting-Up-the-Model"><a class="docs-heading-anchor" href="#Setting-Up-the-Model">Setting Up the Model</a><a id="Setting-Up-the-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Setting-Up-the-Model" title="Permalink"></a></h2><p>Let&#39;s start by importing the necessary libraries and defining our neural masses:</p><pre><code class="language-julia hljs">using Neuroblox
using DifferentialEquations
using CairoMakie

# Convert time units from seconds to milliseconds
τ_factor = 1000

# Define Jansen-Rit neural masses for different brain regions
@named Str = JansenRit(τ=0.0022*τ_factor, H=20/τ_factor, λ=300, r=0.3)
@named GPE = JansenRit(τ=0.04*τ_factor, cortical=false)  # all default subcortical except τ
@named STN = JansenRit(τ=0.01*τ_factor, H=20/τ_factor, λ=500, r=0.1)
@named GPI = JansenRit(cortical=false)  # default parameters subcortical Jansen Rit blox
@named Th  = JansenRit(τ=0.002*τ_factor, H=10/τ_factor, λ=20, r=5)
@named EI  = JansenRit(τ=0.01*τ_factor, H=20/τ_factor, λ=5, r=5)
@named PY  = JansenRit(cortical=true)  # default parameters cortical Jansen Rit blox
@named II  = JansenRit(τ=2.0*τ_factor, H=60/τ_factor, λ=5, r=5)

blox = [Str, GPE, STN, GPI, Th, EI, PY, II]


#Here, we&#39;ve created eight Jansen-Rit neural masses representing different brain regions involved in Parkinson&#39;s disease. The `τ_factor` is used to convert time units from seconds (as in the original paper) to milliseconds (Neuroblox&#39;s default time unit).</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">8-element Vector{JansenRit}:
 JansenRit(Any[τ, H, λ, r], x(t), jcn(t), ODESystem(0x0000000000000925, Equation[Differential(t)(x(t)) ~ y(t) + (-2x(t)) / τ, Differential(t)(y(t)) ~ (-x(t)) / (τ^2) + (H*((2λ) / (1 + exp(-r*jcn(t))) - λ)) / τ], t, SymbolicUtils.BasicSymbolic{Real}[x(t), y(t), jcn(t)], SymbolicUtils.BasicSymbolic{Real}[τ, H, λ, r], nothing, Dict{Any, Any}(:H =&gt; H, :y =&gt; y(t), :λ =&gt; λ, :τ =&gt; τ, :jcn =&gt; jcn(t), :r =&gt; r, :x =&gt; x(t)), Any[], Equation[], Base.RefValue{Vector{Num}}(Num[]), Base.RefValue{Any}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Any}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Matrix{Num}}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Matrix{Num}}(Matrix{Num}(undef, 0, 0)), :Str, ODESystem[], Dict{Any, Any}(τ =&gt; 2.2, H =&gt; 0.02, x(t) =&gt; 1.0, λ =&gt; 300, r =&gt; 0.3, y(t) =&gt; 1.0), Dict{Any, Any}(), nothing, nothing, Equation[], nothing, nothing, nothing, ModelingToolkit.SymbolicContinuousCallback[], ModelingToolkit.SymbolicDiscreteCallback[], Equation[], nothing, nothing, nothing, nothing, false, nothing, nothing, nothing, nothing, nothing), nothing)
 JansenRit(Any[τ, H, λ, r], x(t), jcn(t), ODESystem(0x0000000000000926, Equation[Differential(t)(x(t)) ~ y(t) + (-2x(t)) / τ, Differential(t)(y(t)) ~ (-x(t)) / (τ^2) + (H*((2λ) / (1 + exp(-r*jcn(t))) - λ)) / τ], t, SymbolicUtils.BasicSymbolic{Real}[x(t), y(t), jcn(t)], SymbolicUtils.BasicSymbolic{Real}[τ, H, λ, r], nothing, Dict{Any, Any}(:H =&gt; H, :y =&gt; y(t), :λ =&gt; λ, :τ =&gt; τ, :jcn =&gt; jcn(t), :r =&gt; r, :x =&gt; x(t)), Any[], Equation[], Base.RefValue{Vector{Num}}(Num[]), Base.RefValue{Any}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Any}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Matrix{Num}}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Matrix{Num}}(Matrix{Num}(undef, 0, 0)), :GPE, ODESystem[], Dict{Any, Any}(τ =&gt; 40.0, H =&gt; 0.02, x(t) =&gt; 1.0, λ =&gt; 400.0, r =&gt; 0.1, y(t) =&gt; 1.0), Dict{Any, Any}(), nothing, nothing, Equation[], nothing, nothing, nothing, ModelingToolkit.SymbolicContinuousCallback[], ModelingToolkit.SymbolicDiscreteCallback[], Equation[], nothing, nothing, nothing, nothing, false, nothing, nothing, nothing, nothing, nothing), nothing)
 JansenRit(Any[τ, H, λ, r], x(t), jcn(t), ODESystem(0x0000000000000927, Equation[Differential(t)(x(t)) ~ y(t) + (-2x(t)) / τ, Differential(t)(y(t)) ~ (-x(t)) / (τ^2) + (H*((2λ) / (1 + exp(-r*jcn(t))) - λ)) / τ], t, SymbolicUtils.BasicSymbolic{Real}[x(t), y(t), jcn(t)], SymbolicUtils.BasicSymbolic{Real}[τ, H, λ, r], nothing, Dict{Any, Any}(:H =&gt; H, :y =&gt; y(t), :λ =&gt; λ, :τ =&gt; τ, :jcn =&gt; jcn(t), :r =&gt; r, :x =&gt; x(t)), Any[], Equation[], Base.RefValue{Vector{Num}}(Num[]), Base.RefValue{Any}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Any}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Matrix{Num}}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Matrix{Num}}(Matrix{Num}(undef, 0, 0)), :STN, ODESystem[], Dict{Any, Any}(τ =&gt; 10.0, H =&gt; 0.02, x(t) =&gt; 1.0, λ =&gt; 500, r =&gt; 0.1, y(t) =&gt; 1.0), Dict{Any, Any}(), nothing, nothing, Equation[], nothing, nothing, nothing, ModelingToolkit.SymbolicContinuousCallback[], ModelingToolkit.SymbolicDiscreteCallback[], Equation[], nothing, nothing, nothing, nothing, false, nothing, nothing, nothing, nothing, nothing), nothing)
 JansenRit(Any[τ, H, λ, r], x(t), jcn(t), ODESystem(0x0000000000000928, Equation[Differential(t)(x(t)) ~ y(t) + (-2x(t)) / τ, Differential(t)(y(t)) ~ (-x(t)) / (τ^2) + (H*((2λ) / (1 + exp(-r*jcn(t))) - λ)) / τ], t, SymbolicUtils.BasicSymbolic{Real}[x(t), y(t), jcn(t)], SymbolicUtils.BasicSymbolic{Real}[τ, H, λ, r], nothing, Dict{Any, Any}(:H =&gt; H, :y =&gt; y(t), :λ =&gt; λ, :τ =&gt; τ, :jcn =&gt; jcn(t), :r =&gt; r, :x =&gt; x(t)), Any[], Equation[], Base.RefValue{Vector{Num}}(Num[]), Base.RefValue{Any}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Any}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Matrix{Num}}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Matrix{Num}}(Matrix{Num}(undef, 0, 0)), :GPI, ODESystem[], Dict{Any, Any}(τ =&gt; 14, H =&gt; 0.02, x(t) =&gt; 1.0, λ =&gt; 400.0, r =&gt; 0.1, y(t) =&gt; 1.0), Dict{Any, Any}(), nothing, nothing, Equation[], nothing, nothing, nothing, ModelingToolkit.SymbolicContinuousCallback[], ModelingToolkit.SymbolicDiscreteCallback[], Equation[], nothing, nothing, nothing, nothing, false, nothing, nothing, nothing, nothing, nothing), nothing)
 JansenRit(Any[τ, H, λ, r], x(t), jcn(t), ODESystem(0x0000000000000929, Equation[Differential(t)(x(t)) ~ y(t) + (-2x(t)) / τ, Differential(t)(y(t)) ~ (-x(t)) / (τ^2) + (H*((2λ) / (1 + exp(-r*jcn(t))) - λ)) / τ], t, SymbolicUtils.BasicSymbolic{Real}[x(t), y(t), jcn(t)], SymbolicUtils.BasicSymbolic{Real}[τ, H, λ, r], nothing, Dict{Any, Any}(:H =&gt; H, :y =&gt; y(t), :λ =&gt; λ, :τ =&gt; τ, :jcn =&gt; jcn(t), :r =&gt; r, :x =&gt; x(t)), Any[], Equation[], Base.RefValue{Vector{Num}}(Num[]), Base.RefValue{Any}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Any}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Matrix{Num}}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Matrix{Num}}(Matrix{Num}(undef, 0, 0)), :Th, ODESystem[], Dict{Any, Any}(τ =&gt; 2.0, H =&gt; 0.01, x(t) =&gt; 1.0, λ =&gt; 20, r =&gt; 5, y(t) =&gt; 1.0), Dict{Any, Any}(), nothing, nothing, Equation[], nothing, nothing, nothing, ModelingToolkit.SymbolicContinuousCallback[], ModelingToolkit.SymbolicDiscreteCallback[], Equation[], nothing, nothing, nothing, nothing, false, nothing, nothing, nothing, nothing, nothing), nothing)
 JansenRit(Any[τ, H, λ, r], x(t), jcn(t), ODESystem(0x000000000000092a, Equation[Differential(t)(x(t)) ~ y(t) + (-2x(t)) / τ, Differential(t)(y(t)) ~ (-x(t)) / (τ^2) + (H*((2λ) / (1 + exp(-r*jcn(t))) - λ)) / τ], t, SymbolicUtils.BasicSymbolic{Real}[x(t), y(t), jcn(t)], SymbolicUtils.BasicSymbolic{Real}[τ, H, λ, r], nothing, Dict{Any, Any}(:H =&gt; H, :y =&gt; y(t), :λ =&gt; λ, :τ =&gt; τ, :jcn =&gt; jcn(t), :r =&gt; r, :x =&gt; x(t)), Any[], Equation[], Base.RefValue{Vector{Num}}(Num[]), Base.RefValue{Any}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Any}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Matrix{Num}}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Matrix{Num}}(Matrix{Num}(undef, 0, 0)), :EI, ODESystem[], Dict{Any, Any}(τ =&gt; 10.0, H =&gt; 0.02, x(t) =&gt; 1.0, λ =&gt; 5, r =&gt; 5, y(t) =&gt; 1.0), Dict{Any, Any}(), nothing, nothing, Equation[], nothing, nothing, nothing, ModelingToolkit.SymbolicContinuousCallback[], ModelingToolkit.SymbolicDiscreteCallback[], Equation[], nothing, nothing, nothing, nothing, false, nothing, nothing, nothing, nothing, nothing), nothing)
 JansenRit(Any[τ, H, λ, r], x(t), jcn(t), ODESystem(0x000000000000092b, Equation[Differential(t)(x(t)) ~ y(t) + (-2x(t)) / τ, Differential(t)(y(t)) ~ (-x(t)) / (τ^2) + (H*((2λ) / (1 + exp(-r*jcn(t))) - λ)) / τ], t, SymbolicUtils.BasicSymbolic{Real}[x(t), y(t), jcn(t)], SymbolicUtils.BasicSymbolic{Real}[τ, H, λ, r], nothing, Dict{Any, Any}(:H =&gt; H, :y =&gt; y(t), :λ =&gt; λ, :τ =&gt; τ, :jcn =&gt; jcn(t), :r =&gt; r, :x =&gt; x(t)), Any[], Equation[], Base.RefValue{Vector{Num}}(Num[]), Base.RefValue{Any}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Any}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Matrix{Num}}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Matrix{Num}}(Matrix{Num}(undef, 0, 0)), :PY, ODESystem[], Dict{Any, Any}(τ =&gt; 1, H =&gt; 0.02, x(t) =&gt; 1.0, λ =&gt; 5.0, r =&gt; 0.15, y(t) =&gt; 1.0), Dict{Any, Any}(), nothing, nothing, Equation[], nothing, nothing, nothing, ModelingToolkit.SymbolicContinuousCallback[], ModelingToolkit.SymbolicDiscreteCallback[], Equation[], nothing, nothing, nothing, nothing, false, nothing, nothing, nothing, nothing, nothing), nothing)
 JansenRit(Any[τ, H, λ, r], x(t), jcn(t), ODESystem(0x000000000000092c, Equation[Differential(t)(x(t)) ~ y(t) + (-2x(t)) / τ, Differential(t)(y(t)) ~ (-x(t)) / (τ^2) + (H*((2λ) / (1 + exp(-r*jcn(t))) - λ)) / τ], t, SymbolicUtils.BasicSymbolic{Real}[x(t), y(t), jcn(t)], SymbolicUtils.BasicSymbolic{Real}[τ, H, λ, r], nothing, Dict{Any, Any}(:H =&gt; H, :y =&gt; y(t), :λ =&gt; λ, :τ =&gt; τ, :jcn =&gt; jcn(t), :r =&gt; r, :x =&gt; x(t)), Any[], Equation[], Base.RefValue{Vector{Num}}(Num[]), Base.RefValue{Any}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Any}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Matrix{Num}}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Matrix{Num}}(Matrix{Num}(undef, 0, 0)), :II, ODESystem[], Dict{Any, Any}(τ =&gt; 2000.0, H =&gt; 0.06, x(t) =&gt; 1.0, λ =&gt; 5, r =&gt; 5, y(t) =&gt; 1.0), Dict{Any, Any}(), nothing, nothing, Equation[], nothing, nothing, nothing, ModelingToolkit.SymbolicContinuousCallback[], ModelingToolkit.SymbolicDiscreteCallback[], Equation[], nothing, nothing, nothing, nothing, false, nothing, nothing, nothing, nothing, nothing), nothing)</code></pre><h2 id="Building-the-Circuit"><a class="docs-heading-anchor" href="#Building-the-Circuit">Building the Circuit</a><a id="Building-the-Circuit-1"></a><a class="docs-heading-anchor-permalink" href="#Building-the-Circuit" title="Permalink"></a></h2><p>Now, let&#39;s create a graph representing our brain circuit:</p><pre><code class="language-julia hljs">g = MetaDiGraph()
add_blox!.(Ref(g), blox)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">8-element BitVector:
 1
 1
 1
 1
 1
 1
 1
 1</code></pre><p>We&#39;ve created a MetaDiGraph and added our neural masses as nodes. Next, we&#39;ll define the connections between these nodes based on the known anatomy of the basal ganglia-thalamocortical circuit.</p><p>ModelingToolkit allows us to create parameters that can be passed into the equations symbolically:</p><p>As an alternative to creating edges with an adjacency matrix (as shown in the previous example), here we demonstrate a different approach by adding edges one by one. In this case, we set the connections specified in Table 2 of Liu et al. [1], although we only implement a subset of the nodes and edges to describe a simplified version of the model:</p><pre><code class="language-julia hljs"># Define connection strength parameters
params = @parameters C_Cor=60 C_BG_Th=60 C_Cor_BG_Th=5 C_BG_Th_Cor=5

add_edge!(g, 2, 1, Dict(:weight =&gt; -0.5*C_BG_Th))
add_edge!(g, 2, 2, Dict(:weight =&gt; -0.5*C_BG_Th))
add_edge!(g, 2, 3, Dict(:weight =&gt; C_BG_Th))
add_edge!(g, 3, 2, Dict(:weight =&gt; -0.5*C_BG_Th))
add_edge!(g, 3, 7, Dict(:weight =&gt; C_Cor_BG_Th))
add_edge!(g, 4, 2, Dict(:weight =&gt; -0.5*C_BG_Th))
add_edge!(g, 4, 3, Dict(:weight =&gt; C_BG_Th))
add_edge!(g, 5, 4, Dict(:weight =&gt; -0.5*C_BG_Th))
add_edge!(g, 6, 5, Dict(:weight =&gt; C_BG_Th_Cor))
add_edge!(g, 6, 7, Dict(:weight =&gt; 6*C_Cor))
add_edge!(g, 7, 6, Dict(:weight =&gt; 4.8*C_Cor))
add_edge!(g, 7, 8, Dict(:weight =&gt; -1.5*C_Cor))
add_edge!(g, 8, 7, Dict(:weight =&gt; 1.5*C_Cor))
add_edge!(g, 8, 8, Dict(:weight =&gt; 3.3*C_Cor))
add_edge!(g,1,1,:weight, -0.5*C_BG_Th)
add_edge!(g,1,2,:weight, C_BG_Th)
add_edge!(g,2,1,:weight, -0.5*C_BG_Th)
add_edge!(g,2,5,:weight, C_Cor_BG_Th)
add_edge!(g,3,1,:weight, -0.5*C_BG_Th)
add_edge!(g,3,2,:weight, C_BG_Th)
add_edge!(g,4,3,:weight, -0.5*C_BG_Th)
add_edge!(g,4,4,:weight, C_BG_Th_Cor)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><h2 id="Creating-the-Model"><a class="docs-heading-anchor" href="#Creating-the-Model">Creating the Model</a><a id="Creating-the-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Creating-the-Model" title="Permalink"></a></h2><p>Let&#39;s build the complete model:</p><pre><code class="language-julia hljs">@named final_system = system_from_graph(g)</code></pre><p class="math-container">\[ \begin{align}
\frac{\mathrm{d} Str_{+}x\left( t \right)}{\mathrm{d}t} &amp;= \frac{ - 2 Str_{+}x\left( t \right)}{Str_+\tau} + Str_{+}y\left( t \right) \\
\frac{\mathrm{d} Str_{+}y\left( t \right)}{\mathrm{d}t} &amp;= \frac{ - Str_{+}x\left( t \right)}{Str_+\tau^{2}} + \frac{Str_{+}H \left(  - Str_+\lambda + \frac{2 Str_+\lambda}{1 + e^{ - Str_{+}r Str_{+}jcn\left( t \right)}} \right)}{Str_+\tau} \\
\frac{\mathrm{d} GPE_{+}x\left( t \right)}{\mathrm{d}t} &amp;= GPE_{+}y\left( t \right) + \frac{ - 2 GPE_{+}x\left( t \right)}{GPE_+\tau} \\
\frac{\mathrm{d} GPE_{+}y\left( t \right)}{\mathrm{d}t} &amp;= \frac{GPE_{+}H \left(  - GPE_+\lambda + \frac{2 GPE_+\lambda}{1 + e^{ - GPE_{+}r GPE_{+}jcn\left( t \right)}} \right)}{GPE_+\tau} + \frac{ - GPE_{+}x\left( t \right)}{GPE_+\tau^{2}} \\
\frac{\mathrm{d} STN_{+}x\left( t \right)}{\mathrm{d}t} &amp;= \frac{ - 2 STN_{+}x\left( t \right)}{STN_+\tau} + STN_{+}y\left( t \right) \\
\frac{\mathrm{d} STN_{+}y\left( t \right)}{\mathrm{d}t} &amp;= \frac{STN_{+}H \left(  - STN_+\lambda + \frac{2 STN_+\lambda}{1 + e^{ - STN_{+}r STN_{+}jcn\left( t \right)}} \right)}{STN_+\tau} + \frac{ - STN_{+}x\left( t \right)}{STN_+\tau^{2}} \\
\frac{\mathrm{d} GPI_{+}x\left( t \right)}{\mathrm{d}t} &amp;= \frac{ - 2 GPI_{+}x\left( t \right)}{GPI_+\tau} + GPI_{+}y\left( t \right) \\
\frac{\mathrm{d} GPI_{+}y\left( t \right)}{\mathrm{d}t} &amp;= \frac{ - GPI_{+}x\left( t \right)}{GPI_+\tau^{2}} + \frac{GPI_{+}H \left(  - GPI_+\lambda + \frac{2 GPI_+\lambda}{1 + e^{ - GPI_{+}r GPI_{+}jcn\left( t \right)}} \right)}{GPI_+\tau} \\
\frac{\mathrm{d} Th_{+}x\left( t \right)}{\mathrm{d}t} &amp;= \frac{ - 2 Th_{+}x\left( t \right)}{Th_+\tau} + Th_{+}y\left( t \right) \\
\frac{\mathrm{d} Th_{+}y\left( t \right)}{\mathrm{d}t} &amp;= \frac{Th_{+}H \left(  - Th_+\lambda + \frac{2 Th_+\lambda}{1 + e^{ - Th_{+}r Th_{+}jcn\left( t \right)}} \right)}{Th_+\tau} + \frac{ - Th_{+}x\left( t \right)}{Th_+\tau^{2}} \\
\frac{\mathrm{d} EI_{+}x\left( t \right)}{\mathrm{d}t} &amp;= \frac{ - 2 EI_{+}x\left( t \right)}{EI_+\tau} + EI_{+}y\left( t \right) \\
\frac{\mathrm{d} EI_{+}y\left( t \right)}{\mathrm{d}t} &amp;= \frac{ - EI_{+}x\left( t \right)}{EI_+\tau^{2}} + \frac{EI_{+}H \left(  - EI_+\lambda + \frac{2 EI_+\lambda}{1 + e^{ - EI_{+}r EI_{+}jcn\left( t \right)}} \right)}{EI_+\tau} \\
\frac{\mathrm{d} PY_{+}x\left( t \right)}{\mathrm{d}t} &amp;= \frac{ - 2 PY_{+}x\left( t \right)}{PY_+\tau} + PY_{+}y\left( t \right) \\
\frac{\mathrm{d} PY_{+}y\left( t \right)}{\mathrm{d}t} &amp;= \frac{PY_{+}H \left(  - PY_+\lambda + \frac{2 PY_+\lambda}{1 + e^{ - PY_{+}r PY_{+}jcn\left( t \right)}} \right)}{PY_+\tau} + \frac{ - PY_{+}x\left( t \right)}{PY_+\tau^{2}} \\
\frac{\mathrm{d} II_{+}x\left( t \right)}{\mathrm{d}t} &amp;= \frac{ - 2 II_{+}x\left( t \right)}{II_+\tau} + II_{+}y\left( t \right) \\
\frac{\mathrm{d} II_{+}y\left( t \right)}{\mathrm{d}t} &amp;= \frac{ - II_{+}x\left( t \right)}{II_+\tau^{2}} + \frac{II_{+}H \left(  - II_+\lambda + \frac{2 II_+\lambda}{1 + e^{ - II_{+}r II_{+}jcn\left( t \right)}} \right)}{II_+\tau}
\end{align}
 \]</p><p>This creates a differential equations system from our graph representation using ModelingToolkit and symbolically simplifies it for efficient computation.</p><h2 id="Simulating-the-Model"><a class="docs-heading-anchor" href="#Simulating-the-Model">Simulating the Model</a><a id="Simulating-the-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-the-Model" title="Permalink"></a></h2><p>Lastly, we create the <code>ODEProblem</code> for our system, select an algorithm, in this case <code>Tsit5()</code>, and simulate 1 second of brain activity.</p><pre><code class="language-julia hljs">sim_dur = 1000.0 # Simulate for 1 second
prob = ODEProblem(final_system, [], (0.0, sim_dur))
sol = solve(prob, Tsit5(), saveat=1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: 1st order linear
t: 1001-element Vector{Float64}:
    0.0
    1.0
    2.0
    3.0
    4.0
    5.0
    6.0
    7.0
    8.0
    9.0
    ⋮
  992.0
  993.0
  994.0
  995.0
  996.0
  997.0
  998.0
  999.0
 1000.0
u: 1001-element Vector{Vector{Float64}}:
 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
 [-0.03210451602629839, -1.8599545741238594, 1.8298032952200192, 0.8012787764742771, 2.1870741359269004, 1.9846858220107464, 1.5708512121397193, 0.5289310216509087, 0.9458775916936161, 0.8548979943204849, 1.7238699343376271, 0.9962569278644644, 0.3943035603012185, 0.4575156156720359, 1.9985754749005362, 1.0001496251603792]
 [-2.2047567832745965, -4.36506188180289, 2.423155941836888, 0.5999377020534983, 4.044753875849956, 2.9540245500410296, 1.6479327951034572, 0.10318494476641601, 0.8414553359627284, 0.7310915003985536, 2.309969204541011, 0.9859815229250554, 0.19473476515215524, 0.28120123473061087, 2.9963022990752712, 1.0002990007829835]
 [-4.547045322156712, -6.392976659784171, 2.7910211413445793, 0.3982968119585765, 6.43465607031647, 3.9020189101167664, 1.337830593317828, -0.2840552309558438, 0.7346958114393344, 0.6342868554778455, 2.777963738454008, 0.970450950208424, 0.12986872919703632, 0.2248903325886207, 3.9931810714437215, 1.0004481270799008]
 [-6.645191402655287, -7.958080423494202, 2.9441717929107907, 0.19649365508767408, 9.238662587983162, 4.823953034630571, 0.7166132238964656, -0.6586033477206051, 0.643603919552894, 0.5624024738020469, 3.1450241515647166, 0.9507584519045125, 0.10915591565163371, 0.20732453111926902, 4.989212390538689, 1.000597004263069]
 [-8.365043386519314, -9.12790936984449, 2.8929862885052415, -0.005340835409767599, 12.356316102096393, 5.7162018670821775, -0.17715595945375875, -1.050711050673198, 0.5723785885714563, 0.5108147712116354, 3.4261226382856456, 0.9278367916250005, 0.10269550491786825, 0.2020216952567606, 5.984396854506499, 1.0007456325442767]
 [-9.703014870897318, -9.982407121969153, 2.6474614231915194, -0.20708209297142932, 15.702604035063134, 6.576972322642074, -1.3347600465580156, -1.4815541385774664, 0.5194893254852876, 0.47468068826157245, 3.6342958609401323, 0.9024788948414394, 0.10074313799529412, 0.20049533016396434, 6.97873506110724, 1.000894012135163]
 [-10.70863129648207, -10.595859489832824, 2.2172249124707584, -0.40861168304329865, 19.08805599389182, 6.869214420423677, -2.760770410505101, -1.955813948954987, 0.481533196585348, 0.4498256796461827, 3.7808777365222745, 0.8753560159447686, 0.10018233336659084, 0.20009117169744078, 7.972227607714996, 1.0010421432472179]
 [-11.44618854016602, -11.030353065765018, 1.6115475190544353, -0.6098170762977801, 21.32957873441963, 5.703896008876494, -4.455807778971253, -2.4630082668813085, 0.4549465690798843, 0.4329680109758831, 3.8757053900038683, 0.8470337098292832, 0.10003438404900249, 0.20000074834186343, 8.964875091318081, 1.0011900260917812]
 [-11.97725004525699, -11.334774457644091, 0.8393548779234586, -0.810591427962738, 22.063070187309652, 4.485797653597416, -6.406868756859567, -2.9864183971579488, 0.43666180103207963, 0.42166164403761963, 3.9273025445931116, 0.8179859596705282, 0.09999627064727566, 0.19998449654616637, 9.956678108519286, 1.0013376608800444]
 ⋮
 [-13.18512873336887, -11.992535971257396, 143.22780936036636, 8.033547997817188, -18.049581313703374, 3.2540656574685127, -112.0, -16.0, 0.4, 0.4, 0.9999999999999999, 0.19999999999999998, 0.1, 0.2, 657.7928955843828, 1.0548651157226854]
 [-13.190508960436572, -11.995295045170415, 143.93607664081904, 7.743792579733208, -11.287964733751233, 4.400470381483375, -112.0, -16.0, 0.4, 0.4, 0.9999999999999999, 0.19999999999999998, 0.1, 0.2, 658.1897620963325, 1.0548506178819053]
 [-13.194120006391387, -11.997138566626075, 144.3269781252991, 7.453694331601144, -4.7439380631560795, 5.4803505313587895, -112.0, -16.0, 0.4, 0.4, 0.9999999999999999, 0.19999999999999998, 0.1, 0.2, 658.5862173999684, 1.0548360208759047]
 [-13.196153224094411, -11.998135914991801, 144.41574955444503, 7.163446736883729, 1.5638066534194717, 6.49606683117918, -112.0, -16.0, 0.4, 0.4, 0.9999999999999999, 0.19999999999999998, 0.1, 0.2, 658.982261807229, 1.0548213248074467]
 [-13.197081478452574, -11.998540363118895, 144.21708260889758, 6.873234215897885, 7.620610444716317, 7.450032177971263, -112.0, -16.0, 0.4, 0.4, 0.9999999999999999, 0.19999999999999998, 0.1, 0.2, 659.3778956298437, 1.0548065297792164]
 [-13.19765914641865, -11.998789077342549, 143.74512490929953, 6.583232125814712, 13.415847412879371, 8.344711641704123, -112.0, -16.0, 0.4, 0.4, 0.9999999999999999, 0.19999999999999998, 0.1, 0.2, 659.773119179333, 1.0547916358938212]
 [-13.198408074763853, -11.999181387250205, 143.0134872390398, 6.293606890899484, 18.943740513854816, 9.182691537417877, -112.0, -16.0, 0.4, 0.4, 0.9999999999999999, 0.19999999999999998, 0.1, 0.2, 660.1679327670084, 1.0547766432537902]
 [-13.198929187722458, -11.999452985000984, 142.03527785970397, 6.00451663655283, 24.203638617608956, 9.966731621906218, -112.0, -16.0, 0.4, 0.4, 0.9999999999999999, 0.19999999999999998, 0.1, 0.2, 660.5623367039727, 1.0547615519615752]
 [-13.199281390529253, -11.999634814594213, 140.82311961553725, 5.716111520939858, 29.19649687851931, 10.699510809344494, -112.0, -16.0, 0.4, 0.4, 0.9999999999999999, 0.19999999999999998, 0.1, 0.2, 660.9563313011203, 1.0547463621195499]</code></pre><p><a href="https://doi.org/10.1016/j.neunet.2019.12.021">[1] Liu, C., Zhou, C., Wang, J., Fietkiewicz, C., &amp; Loparo, K. A. (2020). The role of coupling connections in a model of the cortico-basal ganglia-thalamocortical neural loop for the generation of beta oscillations. Neural Networks, 123, 381-392.</a></p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../resting_state/">« Resting state simulation using neural mass models</a><a class="docs-footer-nextpage" href="../neural_assembly/">Tutorial on bottom-up approach to building a neural assembly »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Wednesday 2 October 2024 15:42">Wednesday 2 October 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
