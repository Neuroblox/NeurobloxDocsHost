<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Building a model of Parkinson&#39;s disease using Neural Mass models · Neuroblox</title><meta name="title" content="Building a model of Parkinson&#39;s disease using Neural Mass models · Neuroblox"/><meta property="og:title" content="Building a model of Parkinson&#39;s disease using Neural Mass models · Neuroblox"/><meta property="twitter:title" content="Building a model of Parkinson&#39;s disease using Neural Mass models · Neuroblox"/><meta name="description" content="Documentation for Neuroblox."/><meta property="og:description" content="Documentation for Neuroblox."/><meta property="twitter:description" content="Documentation for Neuroblox."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="Neuroblox logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Neuroblox</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Neuroblox</a></li><li><a class="tocitem" href="../../getting_started/">Getting Started</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../resting_state/">Resting state simulation using neural mass models</a></li><li class="is-active"><a class="tocitem" href>Building a model of Parkinson&#39;s disease using Neural Mass models</a><ul class="internal"><li><a class="tocitem" href="#The-Jansen-Rit-Neural-Mass-Model"><span>The Jansen-Rit Neural Mass Model</span></a></li><li><a class="tocitem" href="#Setting-Up-the-Model"><span>Setting Up the Model</span></a></li><li><a class="tocitem" href="#Building-the-Circuit"><span>Building the Circuit</span></a></li><li><a class="tocitem" href="#Creating-the-Model"><span>Creating the Model</span></a></li><li><a class="tocitem" href="#Simulating-the-Model"><span>Simulating the Model</span></a></li></ul></li><li><a class="tocitem" href="../neural_assembly/">Tutorial on bottom-up approach to building a neural assembly</a></li></ul></li><li><a class="tocitem" href="../../api/">API</a></li><li><a class="tocitem" href="../../release_notes/">Release Notes</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Building a model of Parkinson&#39;s disease using Neural Mass models</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Building a model of Parkinson&#39;s disease using Neural Mass models</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Neuroblox/Neuroblox.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Neuroblox/Neuroblox.jl/blob/master/docs/src/tutorials/parkinsons.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Building-a-model-of-Parkinson&#39;s-disease-using-Neural-Mass-models"><a class="docs-heading-anchor" href="#Building-a-model-of-Parkinson&#39;s-disease-using-Neural-Mass-models">Building a model of Parkinson&#39;s disease using Neural Mass models</a><a id="Building-a-model-of-Parkinson&#39;s-disease-using-Neural-Mass-models-1"></a><a class="docs-heading-anchor-permalink" href="#Building-a-model-of-Parkinson&#39;s-disease-using-Neural-Mass-models" title="Permalink"></a></h1><p>In this example, we&#39;ll construct a model of Parkinson&#39;s disease using eight Jansen-Rit Neural Mass Models, based on the work of Liu et al. (2020) [1].</p><h2 id="The-Jansen-Rit-Neural-Mass-Model"><a class="docs-heading-anchor" href="#The-Jansen-Rit-Neural-Mass-Model">The Jansen-Rit Neural Mass Model</a><a id="The-Jansen-Rit-Neural-Mass-Model-1"></a><a class="docs-heading-anchor-permalink" href="#The-Jansen-Rit-Neural-Mass-Model" title="Permalink"></a></h2><p>The Jansen-Rit model [2] is another popular neural mass model that, like the Wilson-Cowan model from <a href="#example-1-creating-a-simple-neural-circuit">Example 1</a>, describes the average activity of neural populations. Each Jansen-Rit unit is defined by the following differential equations:</p><p class="math-container">\[\begin{align}
\frac{dx}{dt} &amp;= y-\frac{2}{\tau}x \\[10pt]
\frac{dy}{dt} &amp;= -\frac{x}{\tau^2} + \frac{H}{\tau} \left[2\lambda S(\textstyle\sum{jcn}) - \lambda\right]
\end{align}\]</p><p>where <span>$x$</span> represents the average postsynaptic membrane potential of the neural population, <span>$y$</span> is an auxiliary variable, <span>$\tau$</span> is the membrane time constant, <span>$H$</span> is the maximum postsynaptic potential amplitude, <span>$\lambda$</span> determines the maximum firing rate, and <span>$\sum{jcn}$</span> represents the sum of all synaptic inputs to the population. The sigmoid function <span>$S(x)$</span> models the population&#39;s firing rate response to input and is defined as:</p><p class="math-container">\[S(x) = \frac{1}{1 + \text{exp}(-rx)}\]</p><p>where <span>$r$</span> controls the steepness of the sigmoid, affecting the population&#39;s sensitivity to input.</p><h2 id="Setting-Up-the-Model"><a class="docs-heading-anchor" href="#Setting-Up-the-Model">Setting Up the Model</a><a id="Setting-Up-the-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Setting-Up-the-Model" title="Permalink"></a></h2><p>Let&#39;s start by importing the necessary libraries and defining our neural masses:</p><pre><code class="language-julia hljs">using Neuroblox
using DifferentialEquations
using CairoMakie

# Convert time units from seconds to milliseconds
τ_factor = 1000

# Define Jansen-Rit neural masses for different brain regions
@named Str = JansenRit(τ=0.0022*τ_factor, H=20/τ_factor, λ=300, r=0.3)
@named GPE = JansenRit(τ=0.04*τ_factor, cortical=false)  # all default subcortical except τ
@named STN = JansenRit(τ=0.01*τ_factor, H=20/τ_factor, λ=500, r=0.1)
@named GPI = JansenRit(cortical=false)  # default parameters subcortical Jansen Rit blox
@named Th  = JansenRit(τ=0.002*τ_factor, H=10/τ_factor, λ=20, r=5)
@named EI  = JansenRit(τ=0.01*τ_factor, H=20/τ_factor, λ=5, r=5)
@named PY  = JansenRit(cortical=true)  # default parameters cortical Jansen Rit blox
@named II  = JansenRit(τ=2.0*τ_factor, H=60/τ_factor, λ=5, r=5)

blox = [Str, GPE, STN, GPI, Th, EI, PY, II]


#Here, we&#39;ve created eight Jansen-Rit neural masses representing different brain regions involved in Parkinson&#39;s disease. The `τ_factor` is used to convert time units from seconds (as in the original paper) to milliseconds (Neuroblox&#39;s default time unit).</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">8-element Vector{JansenRit}:
 JansenRit(Any[τ, H, λ, r], x(t), jcn(t), ODESystem(0x0000000000000921, Equation[Differential(t)(x(t)) ~ y(t) + (-2x(t)) / τ, Differential(t)(y(t)) ~ (-x(t)) / (τ^2) + (H*((2λ) / (1 + exp(-r*jcn(t))) - λ)) / τ], t, SymbolicUtils.BasicSymbolic{Real}[x(t), y(t), jcn(t)], SymbolicUtils.BasicSymbolic{Real}[τ, H, λ, r], nothing, Dict{Any, Any}(:H =&gt; H, :y =&gt; y(t), :λ =&gt; λ, :τ =&gt; τ, :jcn =&gt; jcn(t), :r =&gt; r, :x =&gt; x(t)), Any[], Equation[], Base.RefValue{Vector{Num}}(Num[]), Base.RefValue{Any}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Any}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Matrix{Num}}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Matrix{Num}}(Matrix{Num}(undef, 0, 0)), :Str, ODESystem[], Dict{Any, Any}(τ =&gt; 2.2, H =&gt; 0.02, x(t) =&gt; 1.0, λ =&gt; 300, r =&gt; 0.3, y(t) =&gt; 1.0), Dict{Any, Any}(), nothing, nothing, Equation[], nothing, nothing, nothing, ModelingToolkit.SymbolicContinuousCallback[], ModelingToolkit.SymbolicDiscreteCallback[], Equation[], nothing, nothing, nothing, nothing, false, nothing, nothing, nothing, nothing, nothing), nothing)
 JansenRit(Any[τ, H, λ, r], x(t), jcn(t), ODESystem(0x0000000000000922, Equation[Differential(t)(x(t)) ~ y(t) + (-2x(t)) / τ, Differential(t)(y(t)) ~ (-x(t)) / (τ^2) + (H*((2λ) / (1 + exp(-r*jcn(t))) - λ)) / τ], t, SymbolicUtils.BasicSymbolic{Real}[x(t), y(t), jcn(t)], SymbolicUtils.BasicSymbolic{Real}[τ, H, λ, r], nothing, Dict{Any, Any}(:H =&gt; H, :y =&gt; y(t), :λ =&gt; λ, :τ =&gt; τ, :jcn =&gt; jcn(t), :r =&gt; r, :x =&gt; x(t)), Any[], Equation[], Base.RefValue{Vector{Num}}(Num[]), Base.RefValue{Any}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Any}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Matrix{Num}}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Matrix{Num}}(Matrix{Num}(undef, 0, 0)), :GPE, ODESystem[], Dict{Any, Any}(τ =&gt; 40.0, H =&gt; 0.02, x(t) =&gt; 1.0, λ =&gt; 400.0, r =&gt; 0.1, y(t) =&gt; 1.0), Dict{Any, Any}(), nothing, nothing, Equation[], nothing, nothing, nothing, ModelingToolkit.SymbolicContinuousCallback[], ModelingToolkit.SymbolicDiscreteCallback[], Equation[], nothing, nothing, nothing, nothing, false, nothing, nothing, nothing, nothing, nothing), nothing)
 JansenRit(Any[τ, H, λ, r], x(t), jcn(t), ODESystem(0x0000000000000923, Equation[Differential(t)(x(t)) ~ y(t) + (-2x(t)) / τ, Differential(t)(y(t)) ~ (-x(t)) / (τ^2) + (H*((2λ) / (1 + exp(-r*jcn(t))) - λ)) / τ], t, SymbolicUtils.BasicSymbolic{Real}[x(t), y(t), jcn(t)], SymbolicUtils.BasicSymbolic{Real}[τ, H, λ, r], nothing, Dict{Any, Any}(:H =&gt; H, :y =&gt; y(t), :λ =&gt; λ, :τ =&gt; τ, :jcn =&gt; jcn(t), :r =&gt; r, :x =&gt; x(t)), Any[], Equation[], Base.RefValue{Vector{Num}}(Num[]), Base.RefValue{Any}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Any}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Matrix{Num}}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Matrix{Num}}(Matrix{Num}(undef, 0, 0)), :STN, ODESystem[], Dict{Any, Any}(τ =&gt; 10.0, H =&gt; 0.02, x(t) =&gt; 1.0, λ =&gt; 500, r =&gt; 0.1, y(t) =&gt; 1.0), Dict{Any, Any}(), nothing, nothing, Equation[], nothing, nothing, nothing, ModelingToolkit.SymbolicContinuousCallback[], ModelingToolkit.SymbolicDiscreteCallback[], Equation[], nothing, nothing, nothing, nothing, false, nothing, nothing, nothing, nothing, nothing), nothing)
 JansenRit(Any[τ, H, λ, r], x(t), jcn(t), ODESystem(0x0000000000000924, Equation[Differential(t)(x(t)) ~ y(t) + (-2x(t)) / τ, Differential(t)(y(t)) ~ (-x(t)) / (τ^2) + (H*((2λ) / (1 + exp(-r*jcn(t))) - λ)) / τ], t, SymbolicUtils.BasicSymbolic{Real}[x(t), y(t), jcn(t)], SymbolicUtils.BasicSymbolic{Real}[τ, H, λ, r], nothing, Dict{Any, Any}(:H =&gt; H, :y =&gt; y(t), :λ =&gt; λ, :τ =&gt; τ, :jcn =&gt; jcn(t), :r =&gt; r, :x =&gt; x(t)), Any[], Equation[], Base.RefValue{Vector{Num}}(Num[]), Base.RefValue{Any}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Any}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Matrix{Num}}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Matrix{Num}}(Matrix{Num}(undef, 0, 0)), :GPI, ODESystem[], Dict{Any, Any}(τ =&gt; 14, H =&gt; 0.02, x(t) =&gt; 1.0, λ =&gt; 400.0, r =&gt; 0.1, y(t) =&gt; 1.0), Dict{Any, Any}(), nothing, nothing, Equation[], nothing, nothing, nothing, ModelingToolkit.SymbolicContinuousCallback[], ModelingToolkit.SymbolicDiscreteCallback[], Equation[], nothing, nothing, nothing, nothing, false, nothing, nothing, nothing, nothing, nothing), nothing)
 JansenRit(Any[τ, H, λ, r], x(t), jcn(t), ODESystem(0x0000000000000925, Equation[Differential(t)(x(t)) ~ y(t) + (-2x(t)) / τ, Differential(t)(y(t)) ~ (-x(t)) / (τ^2) + (H*((2λ) / (1 + exp(-r*jcn(t))) - λ)) / τ], t, SymbolicUtils.BasicSymbolic{Real}[x(t), y(t), jcn(t)], SymbolicUtils.BasicSymbolic{Real}[τ, H, λ, r], nothing, Dict{Any, Any}(:H =&gt; H, :y =&gt; y(t), :λ =&gt; λ, :τ =&gt; τ, :jcn =&gt; jcn(t), :r =&gt; r, :x =&gt; x(t)), Any[], Equation[], Base.RefValue{Vector{Num}}(Num[]), Base.RefValue{Any}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Any}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Matrix{Num}}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Matrix{Num}}(Matrix{Num}(undef, 0, 0)), :Th, ODESystem[], Dict{Any, Any}(τ =&gt; 2.0, H =&gt; 0.01, x(t) =&gt; 1.0, λ =&gt; 20, r =&gt; 5, y(t) =&gt; 1.0), Dict{Any, Any}(), nothing, nothing, Equation[], nothing, nothing, nothing, ModelingToolkit.SymbolicContinuousCallback[], ModelingToolkit.SymbolicDiscreteCallback[], Equation[], nothing, nothing, nothing, nothing, false, nothing, nothing, nothing, nothing, nothing), nothing)
 JansenRit(Any[τ, H, λ, r], x(t), jcn(t), ODESystem(0x0000000000000926, Equation[Differential(t)(x(t)) ~ y(t) + (-2x(t)) / τ, Differential(t)(y(t)) ~ (-x(t)) / (τ^2) + (H*((2λ) / (1 + exp(-r*jcn(t))) - λ)) / τ], t, SymbolicUtils.BasicSymbolic{Real}[x(t), y(t), jcn(t)], SymbolicUtils.BasicSymbolic{Real}[τ, H, λ, r], nothing, Dict{Any, Any}(:H =&gt; H, :y =&gt; y(t), :λ =&gt; λ, :τ =&gt; τ, :jcn =&gt; jcn(t), :r =&gt; r, :x =&gt; x(t)), Any[], Equation[], Base.RefValue{Vector{Num}}(Num[]), Base.RefValue{Any}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Any}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Matrix{Num}}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Matrix{Num}}(Matrix{Num}(undef, 0, 0)), :EI, ODESystem[], Dict{Any, Any}(τ =&gt; 10.0, H =&gt; 0.02, x(t) =&gt; 1.0, λ =&gt; 5, r =&gt; 5, y(t) =&gt; 1.0), Dict{Any, Any}(), nothing, nothing, Equation[], nothing, nothing, nothing, ModelingToolkit.SymbolicContinuousCallback[], ModelingToolkit.SymbolicDiscreteCallback[], Equation[], nothing, nothing, nothing, nothing, false, nothing, nothing, nothing, nothing, nothing), nothing)
 JansenRit(Any[τ, H, λ, r], x(t), jcn(t), ODESystem(0x0000000000000927, Equation[Differential(t)(x(t)) ~ y(t) + (-2x(t)) / τ, Differential(t)(y(t)) ~ (-x(t)) / (τ^2) + (H*((2λ) / (1 + exp(-r*jcn(t))) - λ)) / τ], t, SymbolicUtils.BasicSymbolic{Real}[x(t), y(t), jcn(t)], SymbolicUtils.BasicSymbolic{Real}[τ, H, λ, r], nothing, Dict{Any, Any}(:H =&gt; H, :y =&gt; y(t), :λ =&gt; λ, :τ =&gt; τ, :jcn =&gt; jcn(t), :r =&gt; r, :x =&gt; x(t)), Any[], Equation[], Base.RefValue{Vector{Num}}(Num[]), Base.RefValue{Any}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Any}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Matrix{Num}}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Matrix{Num}}(Matrix{Num}(undef, 0, 0)), :PY, ODESystem[], Dict{Any, Any}(τ =&gt; 1, H =&gt; 0.02, x(t) =&gt; 1.0, λ =&gt; 5.0, r =&gt; 0.15, y(t) =&gt; 1.0), Dict{Any, Any}(), nothing, nothing, Equation[], nothing, nothing, nothing, ModelingToolkit.SymbolicContinuousCallback[], ModelingToolkit.SymbolicDiscreteCallback[], Equation[], nothing, nothing, nothing, nothing, false, nothing, nothing, nothing, nothing, nothing), nothing)
 JansenRit(Any[τ, H, λ, r], x(t), jcn(t), ODESystem(0x0000000000000928, Equation[Differential(t)(x(t)) ~ y(t) + (-2x(t)) / τ, Differential(t)(y(t)) ~ (-x(t)) / (τ^2) + (H*((2λ) / (1 + exp(-r*jcn(t))) - λ)) / τ], t, SymbolicUtils.BasicSymbolic{Real}[x(t), y(t), jcn(t)], SymbolicUtils.BasicSymbolic{Real}[τ, H, λ, r], nothing, Dict{Any, Any}(:H =&gt; H, :y =&gt; y(t), :λ =&gt; λ, :τ =&gt; τ, :jcn =&gt; jcn(t), :r =&gt; r, :x =&gt; x(t)), Any[], Equation[], Base.RefValue{Vector{Num}}(Num[]), Base.RefValue{Any}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Any}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Matrix{Num}}(Matrix{Num}(undef, 0, 0)), Base.RefValue{Matrix{Num}}(Matrix{Num}(undef, 0, 0)), :II, ODESystem[], Dict{Any, Any}(τ =&gt; 2000.0, H =&gt; 0.06, x(t) =&gt; 1.0, λ =&gt; 5, r =&gt; 5, y(t) =&gt; 1.0), Dict{Any, Any}(), nothing, nothing, Equation[], nothing, nothing, nothing, ModelingToolkit.SymbolicContinuousCallback[], ModelingToolkit.SymbolicDiscreteCallback[], Equation[], nothing, nothing, nothing, nothing, false, nothing, nothing, nothing, nothing, nothing), nothing)</code></pre><h2 id="Building-the-Circuit"><a class="docs-heading-anchor" href="#Building-the-Circuit">Building the Circuit</a><a id="Building-the-Circuit-1"></a><a class="docs-heading-anchor-permalink" href="#Building-the-Circuit" title="Permalink"></a></h2><p>Now, let&#39;s create a graph representing our brain circuit:</p><pre><code class="language-julia hljs">g = MetaDiGraph()
add_blox!.(Ref(g), blox)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">8-element BitVector:
 1
 1
 1
 1
 1
 1
 1
 1</code></pre><p>We&#39;ve created a MetaDiGraph and added our neural masses as nodes. Next, we&#39;ll define the connections between these nodes based on the known anatomy of the basal ganglia-thalamocortical circuit.</p><p>ModelingToolkit allows us to create parameters that can be passed into the equations symbolically:</p><p>As an alternative to creating edges with an adjacency matrix (as shown in the previous example), here we demonstrate a different approach by adding edges one by one. In this case, we set the connections specified in Table 2 of Liu et al. [1], although we only implement a subset of the nodes and edges to describe a simplified version of the model:</p><pre><code class="language-julia hljs"># Define connection strength parameters
params = @parameters C_Cor=60 C_BG_Th=60 C_Cor_BG_Th=5 C_BG_Th_Cor=5

add_edge!(g, 2, 1, Dict(:weight =&gt; -0.5*C_BG_Th))
add_edge!(g, 2, 2, Dict(:weight =&gt; -0.5*C_BG_Th))
add_edge!(g, 2, 3, Dict(:weight =&gt; C_BG_Th))
add_edge!(g, 3, 2, Dict(:weight =&gt; -0.5*C_BG_Th))
add_edge!(g, 3, 7, Dict(:weight =&gt; C_Cor_BG_Th))
add_edge!(g, 4, 2, Dict(:weight =&gt; -0.5*C_BG_Th))
add_edge!(g, 4, 3, Dict(:weight =&gt; C_BG_Th))
add_edge!(g, 5, 4, Dict(:weight =&gt; -0.5*C_BG_Th))
add_edge!(g, 6, 5, Dict(:weight =&gt; C_BG_Th_Cor))
add_edge!(g, 6, 7, Dict(:weight =&gt; 6*C_Cor))
add_edge!(g, 7, 6, Dict(:weight =&gt; 4.8*C_Cor))
add_edge!(g, 7, 8, Dict(:weight =&gt; -1.5*C_Cor))
add_edge!(g, 8, 7, Dict(:weight =&gt; 1.5*C_Cor))
add_edge!(g, 8, 8, Dict(:weight =&gt; 3.3*C_Cor))
add_edge!(g,1,1,:weight, -0.5*C_BG_Th)
add_edge!(g,1,2,:weight, C_BG_Th)
add_edge!(g,2,1,:weight, -0.5*C_BG_Th)
add_edge!(g,2,5,:weight, C_Cor_BG_Th)
add_edge!(g,3,1,:weight, -0.5*C_BG_Th)
add_edge!(g,3,2,:weight, C_BG_Th)
add_edge!(g,4,3,:weight, -0.5*C_BG_Th)
add_edge!(g,4,4,:weight, C_BG_Th_Cor)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><h2 id="Creating-the-Model"><a class="docs-heading-anchor" href="#Creating-the-Model">Creating the Model</a><a id="Creating-the-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Creating-the-Model" title="Permalink"></a></h2><p>Let&#39;s build the complete model:</p><pre><code class="language-julia hljs">@named final_system = system_from_graph(g)</code></pre><p class="math-container">\[ \begin{align}
\frac{\mathrm{d} Str_{+}x\left( t \right)}{\mathrm{d}t} &amp;= \frac{ - 2 Str_{+}x\left( t \right)}{Str_+\tau} + Str_{+}y\left( t \right) \\
\frac{\mathrm{d} Str_{+}y\left( t \right)}{\mathrm{d}t} &amp;= \frac{ - Str_{+}x\left( t \right)}{Str_+\tau^{2}} + \frac{Str_{+}H \left(  - Str_+\lambda + \frac{2 Str_+\lambda}{1 + e^{ - Str_{+}r Str_{+}jcn\left( t \right)}} \right)}{Str_+\tau} \\
\frac{\mathrm{d} GPE_{+}x\left( t \right)}{\mathrm{d}t} &amp;= GPE_{+}y\left( t \right) + \frac{ - 2 GPE_{+}x\left( t \right)}{GPE_+\tau} \\
\frac{\mathrm{d} GPE_{+}y\left( t \right)}{\mathrm{d}t} &amp;= \frac{GPE_{+}H \left(  - GPE_+\lambda + \frac{2 GPE_+\lambda}{1 + e^{ - GPE_{+}r GPE_{+}jcn\left( t \right)}} \right)}{GPE_+\tau} + \frac{ - GPE_{+}x\left( t \right)}{GPE_+\tau^{2}} \\
\frac{\mathrm{d} STN_{+}x\left( t \right)}{\mathrm{d}t} &amp;= \frac{ - 2 STN_{+}x\left( t \right)}{STN_+\tau} + STN_{+}y\left( t \right) \\
\frac{\mathrm{d} STN_{+}y\left( t \right)}{\mathrm{d}t} &amp;= \frac{STN_{+}H \left(  - STN_+\lambda + \frac{2 STN_+\lambda}{1 + e^{ - STN_{+}r STN_{+}jcn\left( t \right)}} \right)}{STN_+\tau} + \frac{ - STN_{+}x\left( t \right)}{STN_+\tau^{2}} \\
\frac{\mathrm{d} GPI_{+}x\left( t \right)}{\mathrm{d}t} &amp;= \frac{ - 2 GPI_{+}x\left( t \right)}{GPI_+\tau} + GPI_{+}y\left( t \right) \\
\frac{\mathrm{d} GPI_{+}y\left( t \right)}{\mathrm{d}t} &amp;= \frac{ - GPI_{+}x\left( t \right)}{GPI_+\tau^{2}} + \frac{GPI_{+}H \left(  - GPI_+\lambda + \frac{2 GPI_+\lambda}{1 + e^{ - GPI_{+}r GPI_{+}jcn\left( t \right)}} \right)}{GPI_+\tau} \\
\frac{\mathrm{d} Th_{+}x\left( t \right)}{\mathrm{d}t} &amp;= \frac{ - 2 Th_{+}x\left( t \right)}{Th_+\tau} + Th_{+}y\left( t \right) \\
\frac{\mathrm{d} Th_{+}y\left( t \right)}{\mathrm{d}t} &amp;= \frac{Th_{+}H \left(  - Th_+\lambda + \frac{2 Th_+\lambda}{1 + e^{ - Th_{+}r Th_{+}jcn\left( t \right)}} \right)}{Th_+\tau} + \frac{ - Th_{+}x\left( t \right)}{Th_+\tau^{2}} \\
\frac{\mathrm{d} EI_{+}x\left( t \right)}{\mathrm{d}t} &amp;= \frac{ - 2 EI_{+}x\left( t \right)}{EI_+\tau} + EI_{+}y\left( t \right) \\
\frac{\mathrm{d} EI_{+}y\left( t \right)}{\mathrm{d}t} &amp;= \frac{ - EI_{+}x\left( t \right)}{EI_+\tau^{2}} + \frac{EI_{+}H \left(  - EI_+\lambda + \frac{2 EI_+\lambda}{1 + e^{ - EI_{+}r EI_{+}jcn\left( t \right)}} \right)}{EI_+\tau} \\
\frac{\mathrm{d} PY_{+}x\left( t \right)}{\mathrm{d}t} &amp;= \frac{ - 2 PY_{+}x\left( t \right)}{PY_+\tau} + PY_{+}y\left( t \right) \\
\frac{\mathrm{d} PY_{+}y\left( t \right)}{\mathrm{d}t} &amp;= \frac{PY_{+}H \left(  - PY_+\lambda + \frac{2 PY_+\lambda}{1 + e^{ - PY_{+}r PY_{+}jcn\left( t \right)}} \right)}{PY_+\tau} + \frac{ - PY_{+}x\left( t \right)}{PY_+\tau^{2}} \\
\frac{\mathrm{d} II_{+}x\left( t \right)}{\mathrm{d}t} &amp;= \frac{ - 2 II_{+}x\left( t \right)}{II_+\tau} + II_{+}y\left( t \right) \\
\frac{\mathrm{d} II_{+}y\left( t \right)}{\mathrm{d}t} &amp;= \frac{ - II_{+}x\left( t \right)}{II_+\tau^{2}} + \frac{II_{+}H \left(  - II_+\lambda + \frac{2 II_+\lambda}{1 + e^{ - II_{+}r II_{+}jcn\left( t \right)}} \right)}{II_+\tau}
\end{align}
 \]</p><p>This creates a differential equations system from our graph representation using ModelingToolkit and symbolically simplifies it for efficient computation.</p><h2 id="Simulating-the-Model"><a class="docs-heading-anchor" href="#Simulating-the-Model">Simulating the Model</a><a id="Simulating-the-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-the-Model" title="Permalink"></a></h2><p>Lastly, we create the <code>ODEProblem</code> for our system, select an algorithm, in this case <code>Tsit5()</code>, and simulate 1 second of brain activity.</p><pre><code class="language-julia hljs">sim_dur = 1000.0 # Simulate for 1 second
prob = ODEProblem(final_system, [], (0.0, sim_dur))
sol = solve(prob, Tsit5(), saveat=1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: 1st order linear
t: 1001-element Vector{Float64}:
    0.0
    1.0
    2.0
    3.0
    4.0
    5.0
    6.0
    7.0
    8.0
    9.0
    ⋮
  992.0
  993.0
  994.0
  995.0
  996.0
  997.0
  998.0
  999.0
 1000.0
u: 1001-element Vector{Vector{Float64}}:
 [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
 [-0.03210451602623925, -1.8599545741238357, 1.8298032952200747, 0.8012787764743324, 2.1870741359269004, 1.9846858220107462, 1.5708512121397118, 0.5289310216509164, 0.9458775916936205, 0.8548979943204869, 1.7238699343376265, 0.9962569278644644, 0.39430356030110797, 0.45751561567193216, 1.9985754749005353, 1.000149625160379]
 [-2.2047567832735124, -4.36506188180251, 2.4231559418369955, 0.5999377020535547, 4.04475387584995, 2.9540245500410283, 1.6479327951034015, 0.10318494476646428, 0.8414553359628015, 0.7310915003985817, 2.30996920454101, 0.9859815229250553, 0.19473476515102242, 0.2812012347295623, 2.996302299075269, 1.000299000782983]
 [-4.547045322159084, -6.3929766597849, 2.7910211413447374, 0.3982968119586325, 6.434656070316492, 3.9020189101167686, 1.3378305933177894, -0.2840552309559713, 0.7346958114391958, 0.6342868554777997, 2.7779637384540052, 0.9704509502084236, 0.1298687291978919, 0.22489033258940067, 3.993181071443721, 1.0004481270799002]
 [-6.645191402670226, -7.9580804234988, 2.9441717929109954, 0.19649365508772978, 9.238662587983264, 4.82395303463058, 0.7166132238962143, -0.6586033477211084, 0.6436039195520263, 0.5624024738017603, 3.145024151564706, 0.9507584519045116, 0.10915591565685416, 0.20732453112402788, 4.989212390538689, 1.0005970042630683]
 [-8.365043386532978, -9.127909369848496, 2.89298628850549, -0.005340835409712538, 12.356316102096516, 5.71620186708215, -0.177155959453665, -1.0507110506735677, 0.572378588570704, 0.5108147712114033, 3.4261226382856336, 0.9278367916249993, 0.1026955049210582, 0.20202169525964564, 5.9843968545065, 1.0007456325442758]
 [-9.703014870929994, -9.982407121977749, 2.6474614231918085, -0.20708209297137412, 15.702604035507074, 6.576972317301709, -1.3347600465575706, -1.48155413857828, 0.5194893254836137, 0.4746806882611265, 3.634295860940081, 0.9024788948414352, 0.10074313800046704, 0.20049533016860072, 6.978735061107238, 1.0008940121351624]
 [-10.708631296436419, -10.595859489821454, 2.2172249124710928, -0.40861168304324347, 19.088056031780518, 6.869214689527383, -2.7607704105097794, -1.955813948953327, 0.48153319658757765, 0.44982567964672165, 3.7808777365223474, 0.8753560159447745, 0.10018233336116492, 0.20009117169261617, 7.972227607714993, 1.001042143247217]
 [-11.446188540184744, -11.03035306576901, 1.611547519054803, -0.6098170762977249, 21.329579059394806, 5.703896310782629, -4.455807778970726, -2.463008266880318, 0.4549465690790194, 0.43296801097571963, 3.8757053900038114, 0.8470337098292787, 0.10003438405086693, 0.2000007483435102, 8.96487509131808, 1.0011900260917803]
 [-11.977250045155962, -11.334774457640508, 0.8393548779239174, -0.8105914279626821, 22.06307072517133, 4.485797951156292, -6.406868756872047, -2.9864183971563785, 0.4366618010354751, 0.42166164403699063, 3.927302544594074, 0.8179859596706031, 0.09999627064188067, 0.1999844965415585, 9.956678108519284, 1.0013376608800435]
 ⋮
 [-13.08606058991552, -11.941411730698162, 134.4457979865129, 9.251123185114473, -55.05799112551088, -3.7873247595222432, -112.0, -16.0, 0.4, 0.4, 0.9999999999999999, 0.19999999999999998, 0.1, 0.2, 657.7928955843819, 1.0548651157226834]
 [-13.123477115427216, -11.960913699702948, 136.94395765780052, 9.275122259851658, -47.79595801539643, -2.2730225319996817, -112.0, -16.0, 0.4, 0.4, 0.9999999999999999, 0.19999999999999998, 0.1, 0.2, 658.1897620963314, 1.054850617881903]
 [-13.148934420328153, -11.974127826530657, 139.2031805642049, 9.0131493901881, -40.51207889439273, -0.8315295966837887, -112.0, -16.0, 0.4, 0.4, 0.9999999999999999, 0.19999999999999998, 0.1, 0.2, 658.5862173999673, 1.0548360208759024]
 [-13.165808398242266, -11.982750334738814, 141.06113094553317, 8.690375887829232, -33.275389461409226, 0.5373632024715742, -112.0, -16.0, 0.4, 0.4, 0.9999999999999999, 0.19999999999999998, 0.1, 0.2, 658.9822618072279, 1.0548213248074445]
 [-13.176964421728027, -11.988366333191895, 142.50144680344033, 8.405100154068208, -26.143422736122787, 1.8343819181992884, -112.0, -16.0, 0.4, 0.4, 0.9999999999999999, 0.19999999999999998, 0.1, 0.2, 659.3778956298427, 1.0548065297792142]
 [-13.184645285375899, -11.992280007404794, 143.60674274098432, 8.117509909895832, -19.162378618894284, 3.0607632418163657, -112.0, -16.0, 0.4, 0.4, 0.9999999999999999, 0.19999999999999998, 0.1, 0.2, 659.773119179332, 1.054791635893819]
 [-13.189804282236642, -11.99489891885093, 144.37829154534262, 7.827497471199225, -12.367623657501781, 4.218241303604233, -112.0, -16.0, 0.4, 0.4, 0.9999999999999999, 0.19999999999999998, 0.1, 0.2, 660.1679327670073, 1.054776643253788]
 [-13.19319994530957, -11.996607873608935, 144.82912539272962, 7.537103836151018, -5.786786325488266, 5.308834687904132, -112.0, -16.0, 0.4, 0.4, 0.9999999999999999, 0.19999999999999998, 0.1, 0.2, 660.5623367039717, 1.054761551961573]
 [-13.195480028260556, -11.997752273630809, 144.9746128202959, 7.2465246567592, 0.559054744746166, 6.334773028196878, -112.0, -16.0, 0.4, 0.4, 0.9999999999999999, 0.19999999999999998, 0.1, 0.2, 660.9563313011192, 1.0547463621195476]</code></pre><p><a href="https://doi.org/10.1016/j.neunet.2019.12.021">[1] Liu, C., Zhou, C., Wang, J., Fietkiewicz, C., &amp; Loparo, K. A. (2020). The role of coupling connections in a model of the cortico-basal ganglia-thalamocortical neural loop for the generation of beta oscillations. Neural Networks, 123, 381-392.</a></p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../resting_state/">« Resting state simulation using neural mass models</a><a class="docs-footer-nextpage" href="../neural_assembly/">Tutorial on bottom-up approach to building a neural assembly »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Friday 4 October 2024 07:12">Friday 4 October 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
