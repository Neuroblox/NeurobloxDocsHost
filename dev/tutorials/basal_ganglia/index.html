<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Basal Ganglia Model and Parkinson&#39;s Disease Simulation · Neuroblox</title><meta name="title" content="Basal Ganglia Model and Parkinson&#39;s Disease Simulation · Neuroblox"/><meta property="og:title" content="Basal Ganglia Model and Parkinson&#39;s Disease Simulation · Neuroblox"/><meta property="twitter:title" content="Basal Ganglia Model and Parkinson&#39;s Disease Simulation · Neuroblox"/><meta name="description" content="Documentation for Neuroblox."/><meta property="og:description" content="Documentation for Neuroblox."/><meta property="twitter:description" content="Documentation for Neuroblox."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="Neuroblox logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Neuroblox</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Neuroblox</a></li><li><a class="tocitem" href="../../getting_started/">Getting Started</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../resting_state/">Resting state simulation using neural mass models</a></li><li><a class="tocitem" href="../parkinsons/">Building a model of Parkinson&#39;s disease using Neural Mass models</a></li><li><a class="tocitem" href="../neural_assembly/">Tutorial on bottom-up approach to building a neural assembly</a></li><li><a class="tocitem" href="../ping_network/">Pyramidal-Interneuron Gamma network</a></li><li class="is-active"><a class="tocitem" href>Basal Ganglia Model and Parkinson&#39;s Disease Simulation</a><ul class="internal"><li><a class="tocitem" href="#Introduction"><span>Introduction</span></a></li><li><a class="tocitem" href="#Isolated-MSN-network-in-baseline-condition"><span>Isolated MSN network in baseline condition</span></a></li><li><a class="tocitem" href="#Core-striatal-network:-MSN-FSI"><span>Core striatal network: MSN + FSI</span></a></li><li><a class="tocitem" href="#Full-basal-ganglia-model-in-baseline-condition"><span>Full basal ganglia model in baseline condition</span></a></li><li><a class="tocitem" href="#Full-basal-ganglia-model-in-Parkinson&#39;s-condition"><span>Full basal ganglia model in Parkinson&#39;s condition</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../spectralDCM/">Spectral Dynamic Causal Modeling Tutorial</a></li></ul></li><li><a class="tocitem" href="../../api/">API</a></li><li><a class="tocitem" href="../../release_notes/">Release Notes</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Basal Ganglia Model and Parkinson&#39;s Disease Simulation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Basal Ganglia Model and Parkinson&#39;s Disease Simulation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Neuroblox/Neuroblox.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Neuroblox/Neuroblox.jl/blob/master/docs/src/tutorials/basal_ganglia.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Basal-Ganglia-Model-and-Parkinson&#39;s-Disease-Simulation"><a class="docs-heading-anchor" href="#Basal-Ganglia-Model-and-Parkinson&#39;s-Disease-Simulation">Basal Ganglia Model and Parkinson&#39;s Disease Simulation</a><a id="Basal-Ganglia-Model-and-Parkinson&#39;s-Disease-Simulation-1"></a><a class="docs-heading-anchor-permalink" href="#Basal-Ganglia-Model-and-Parkinson&#39;s-Disease-Simulation" title="Permalink"></a></h1><h2 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h2><p>This tutorial demonstrates how to build and simulate a basal ganglia model using Neuroblox, based on the work of <a href="https://doi.org/10.1073/pnas.2120808119">Adam et al. (2022)</a>. We&#39;ll explore the model&#39;s behavior in both normal and Parkinsonian conditions, showcasing the emergence of pathological beta oscillations characteristic of Parkinson&#39;s disease.</p><p><img src="../../assets/basal_ganglia_baseline.jpg" alt="Full basal ganglia model in baseline condition"/></p><p>We&#39;ll start with simple components and gradually build up to the full basal ganglia circuit, demonstrating how to analyze the results at each stage.</p><pre><code class="language-julia hljs">using Neuroblox
using StochasticDiffEq ## For building and solving differential equations problems
using CairoMakie ## For plotting
using Random ## For setting a random seed

Random.seed!(123) ## Set a random seed for reproducibility</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Random.TaskLocalRNG()</code></pre><h2 id="Isolated-MSN-network-in-baseline-condition"><a class="docs-heading-anchor" href="#Isolated-MSN-network-in-baseline-condition">Isolated MSN network in baseline condition</a><a id="Isolated-MSN-network-in-baseline-condition-1"></a><a class="docs-heading-anchor-permalink" href="#Isolated-MSN-network-in-baseline-condition" title="Permalink"></a></h2><p>We&#39;ll start by simulating an isolated network of Medium Spiny Neurons (MSNs)</p><p>Blox definition</p><pre><code class="language-julia hljs">N_MSN = 100 ## number of Medium Spiny Neurons
@named msn = Striatum_MSN_Adam(N_inhib = N_MSN)
sys = get_system(msn; simplify = true)

# Check the system&#39;s variables (100 neurons, each with associated currents)
unknowns(sys)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">600-element Vector{SymbolicUtils.BasicSymbolic{Real}}:
 inh1₊V(t)
 inh1₊n(t)
 inh1₊m(t)
 inh1₊h(t)
 inh1₊mM(t)
 inh1₊G(t)
 inh2₊V(t)
 inh2₊n(t)
 inh2₊m(t)
 inh2₊h(t)
 ⋮
 inh99₊h(t)
 inh99₊mM(t)
 inh99₊G(t)
 inh100₊V(t)
 inh100₊n(t)
 inh100₊m(t)
 inh100₊h(t)
 inh100₊mM(t)
 inh100₊G(t)</code></pre><p>Create and solve the SDE problem</p><pre><code class="language-julia hljs"># Define simulation parameters
tspan = (0.0, 2000.0) ## simulation time span [ms]
dt = 0.05 ## time step for solving and saving [ms]

# Create a stochastic differential equation problem and use the RKMil method to solve it
prob = SDEProblem(sys, [], tspan, [])
sol = solve(prob, RKMil(); dt=dt, saveat=dt, abstol = 1e-2, reltol = 1e-2)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: 1st order linear
t: 40001-element Vector{Float64}:
    0.0
    0.05
    0.1
    0.15
    0.2
    0.25
    0.3
    0.35
    0.4
    0.45
    ⋮
 1999.6
 1999.65
 1999.7
 1999.75
 1999.8
 1999.85
 1999.9
 1999.95
 2000.0
u: 40001-element Vector{Vector{Float64}}:
 [-63.83, 0.062, 0.027, 0.99, 0.022, 0.0, -63.83, 0.062, 0.027, 0.99  …  0.027, 0.99, 0.022, 0.0, -63.83, 0.062, 0.027, 0.99, 0.022, 0.0]
 [-63.77935061279409, 0.06200034647502893, 0.02740434868121592, 0.9900128602371656, 0.02200044288494642, 2.7533531010703883e-15, -63.837956967530715, 0.06200034647502893, 0.02740434868121592, 0.9900128602371656  …  0.027404348681215916, 0.9900128602371656, 0.02200044288494642, 2.7533531010703883e-15, -63.813515293245764, 0.06200034647502893, 0.02740434868121592, 0.9900128602371656, 0.02200044288494642, 2.7533531010703883e-15]
 [-63.81068072172045, 0.062015730796735634, 0.027738544961550725, 0.9900238808875442, 0.02200095632665141, 5.573831994245028e-15, -63.8541094176761, 0.06199832443411218, 0.027571514070591868, 0.9900258011773999  …  0.027588854683140856, 0.9900256018792098, 0.022000882932715234, 5.496116382521268e-15, -63.792469508185754, 0.06200557192096611, 0.0276410210353958, 0.9900250022407344, 0.022000908541108612, 5.5183208430137705e-15]
 [-63.76090873759339, 0.062021321256908256, 0.02780626813750163, 0.9900357758433216, 0.0220014256947438, 8.340426922452448e-15, -63.87238347127478, 0.06199159059503684, 0.027604235137240227, 0.9900390878094227  …  0.02770097799987209, 0.9900378741030733, 0.022001335214648608, 8.239102053867593e-15, -63.77535144323796, 0.06201688077614812, 0.027812288605317165, 0.9900362861480113, 0.022001403330955346, 8.304948745548916e-15]
 [-63.73439036429927, 0.06204107991248593, 0.027976815867763887, 0.9900459271610805, 0.022001962217379697, 1.1158264297731081e-14, -63.87002451392999, 0.06197982459095486, 0.02756974115102495, 0.9900527707511275  …  0.027744317421561367, 0.9900501063163498, 0.022001781869235605, 1.0972188641884095e-14, -63.7711719649593, 0.0620327923636617, 0.027942958529232342, 0.9900468715050024, 0.02200192111576806, 1.1109167662835244e-14]
 [-63.73501629232731, 0.06206778908741721, 0.028143692730943637, 0.9900551276082425, 0.022002533556958206, 1.4003803928733205e-14, -63.85654708291575, 0.06196858624108057, 0.02755118104178559, 0.9900662630196982  …  0.02773261143955615, 0.9900625612652305, 0.02200221235411372, 1.3679194207496034e-14, -63.778175609374394, 0.06204961675853273, 0.028024300423458787, 0.9900571783630076, 0.02200244496926538, 1.3910237717406908e-14]
 [-63.7564028770842, 0.062097567583569914, 0.02827394481404282, 0.9900638368399639, 0.022003121543337736, 1.6861997473184028e-14, -63.83658905282013, 0.06195932569294259, 0.027565440060906176, 0.9900794344291253  …  0.027685920916601957, 0.990075205817626, 0.022002629425491645, 1.636363322509425e-14, -63.792521781967245, 0.06206604346768675, 0.028062593464616776, 0.9900673864703158, 0.022002968506216542, 1.6702482673602065e-14]
 [-63.78099613705215, 0.06211702453586041, 0.028214629126374857, 0.990073368493166, 0.022003666929275797, 1.9661926215105095e-14, -63.8075648864017, 0.061958680035894095, 0.027649559725891767, 0.9900914453848854  …  0.027731125044950795, 0.9900869796349971, 0.022003072763333777, 1.9065544426336293e-14, -63.79011534079304, 0.06207541568596647, 0.02800876662223134, 0.9900780908582753, 0.02200346196255683, 1.94475057981968e-14]
 [-63.77987282347328, 0.06213140840063029, 0.02813029122203666, 0.9900833319722592, 0.02200419012118738, 2.243350260260472e-14, -63.80558076380302, 0.06196354995840846, 0.027758023477228742, 0.9901027437018374  …  0.02773593042072018, 0.9900989360101158, 0.022003503631395447, 2.174793384732007e-14, -63.78216172918764, 0.06208505608545844, 0.02797756919402373, 0.9900886498249554, 0.02200395739027859, 2.2190080840818458e-14]
 [-63.737989257660594, 0.06213775152363617, 0.028006293607159245, 0.9900939798867108, 0.022004678136013034, 2.516014107815677e-14, -63.84645456722235, 0.06197716196368081, 0.027905072116178254, 0.9901129125006009  …  0.02767670458556359, 0.9901111817355949, 0.02200391473510569, 2.4399381638932744e-14, -63.765415963932846, 0.062095121546782046, 0.02798223893249414, 0.9900989783018304, 0.022004455942600355, 2.4928775722713016e-14]
 ⋮
 [-64.66637193932891, 0.05395971777367343, 0.02534562174324553, 0.9930775265143129, 0.02217904247205345, 0.014449916360062015, -63.41917651511269, 0.06734114794609838, 0.027917629245992257, 0.9894493779973368  …  0.03510720105182048, 0.9881166078217007, 0.0225934024996708, 1.069456907718295e-12, -63.870933904922886, 0.061988151201604905, 0.026140935997242615, 0.990903902386822, 0.022055241643442507, 6.716958509600521e-13]
 [-64.65347911272531, 0.053976888763631097, 0.023573988081338093, 0.9930716118519207, 0.022178226975799107, 0.014394162019415391, -63.42499279795254, 0.06729820983508886, 0.0299267092611084, 0.989455822044426  …  0.03494163784044523, 0.9881110368243263, 0.02259525981383643, 1.0703869894587687e-12, -63.87455649395551, 0.06197736714164596, 0.027486516293930667, 0.990905403112711, 0.02205560035580491, 6.718217509159919e-13]
 [-64.64058628612176, 0.053994059753588695, 0.021802354419438716, 0.9930656971895285, 0.022177411479544766, 0.014338407678769023, -63.43080908079237, 0.06725527172407954, 0.03193578927621541, 0.9894622660915152  …  0.03477607462907073, 0.9881054658269518, 0.02259711712800205, 1.0713170711992378e-12, -63.878179082988126, 0.06196658308168706, 0.028832096590612595, 0.9909069038386003, 0.022055959068167312, 6.719476508719312e-13]
 [-64.62769345951823, 0.05401123074354629, 0.02003072075753933, 0.9930597825271363, 0.022176595983290425, 0.014282653338122654, -63.4366253636322, 0.0672123336130702, 0.03394486929132242, 0.9894687101386043  …  0.03461051141769623, 0.9880998948295774, 0.022598974442167668, 1.0722471529397072e-12, -63.881801672020735, 0.06195579902172815, 0.030177676887294523, 0.9909084045644893, 0.022056317780529713, 6.720735508278704e-13]
 [-64.61480063291468, 0.054028401733503886, 0.01825908709563995, 0.9930538678647443, 0.022175780487036084, 0.014226898997476284, -63.44244164647203, 0.06716939550206089, 0.03595394930642942, 0.9894751541856933  …  0.03444494820632173, 0.9880943238322029, 0.02260083175633329, 1.0731772346801765e-12, -63.885424261053345, 0.06194501496176925, 0.03152325718397645, 0.9909099052903784, 0.022056676492892113, 6.721994507838096e-13]
 [-64.60190780631113, 0.054045572723461485, 0.01648745343374057, 0.9930479532023521, 0.022174964990781743, 0.014171144656829915, -63.44825792931186, 0.06712645739105155, 0.03796302932153643, 0.9894815982327825  …  0.034279384994947225, 0.9880887528348284, 0.022602689070498908, 1.0741073164206457e-12, -63.88904685008596, 0.06193423090181035, 0.03286883748065838, 0.9909114060162674, 0.022057035205254514, 6.723253507397488e-13]
 [-64.56946712127652, 0.054078536977109785, 0.020036847335492314, 0.9930406346928189, 0.022174244648495895, 0.014116544206776651, -63.40853538934521, 0.0670810717428095, 0.03418858789720833, 0.9894886639511687  …  0.03475662167766388, 0.9880814068110522, 0.022604621613328865, 1.0751493387037816e-12, -63.876755573651515, 0.061919532066953685, 0.0303125939064031, 0.9909134135155405, 0.02205736566826033, 6.72418370574464e-13]
 [-64.53506858832596, 0.05411308303106173, 0.024119177505605015, 0.993033175578666, 0.022173533836512282, 0.014062059326534107, -63.3642518336722, 0.0670354409574501, 0.02983488836961912, 0.9894957919340663  …  0.03529823904113447, 0.9880738830065868, 0.022606561690809428, 1.0762025725760971e-12, -63.862870417844015, 0.06190444114137767, 0.027365556744122596, 0.9909154717715355, 0.022057693301905365, 6.725080972465518e-13]
 [-64.50067005537541, 0.05414762908501367, 0.02820150767571772, 0.9930257164645132, 0.022172823024528672, 0.014007574446291565, -63.31996827799919, 0.0669898101720907, 0.025481188842029913, 0.9895029199169639  …  0.035839856404605075, 0.9880663592021216, 0.022608501768289994, 1.0772558064484127e-12, -63.848985262036514, 0.06188935021580166, 0.02441851958184209, 0.9909175300275305, 0.022058020935550402, 6.725978239186396e-13]</code></pre><p>Plot voltage of a single neuron</p><pre><code class="language-julia hljs">plot(sol, idxs=1, axis = (xlabel = &quot;time (ms)&quot;, ylabel = &quot;membrane potential (mV)&quot;))</code></pre><img src="06effa92.png" alt="Example block output"/><p>Plot mean field</p><pre><code class="language-julia hljs">meanfield(msn, sol, axis = (xlabel = &quot;time (ms)&quot;, ylabel = &quot;membrane potential (mV)&quot;, title = &quot;Mean Field&quot;))</code></pre><img src="a29c4006.png" alt="Example block output"/><p>Detect spikes and compute firing rate</p><pre><code class="language-julia hljs">spikes = detect_spikes(msn, sol; threshold=-55)
t, fr = mean_firing_rate(spikes, sol)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(0.0:2000.0:2000.0, [1.545])</code></pre><p>Create a raster plot</p><pre><code class="language-julia hljs">rasterplot(msn, sol, threshold = -55.0, axis = (; title = &quot;Neuron&#39;s Spikes - Mean Firing Rate: $(round(fr[1], digits=2)) spikes/s&quot;))</code></pre><img src="4d36386c.png" alt="Example block output"/><p>Compute and plot the power spectrum of the GABAa current</p><pre><code class="language-julia hljs">fig = Figure(size = (1500, 600))

powerspectrumplot(fig[1,1], msn, sol; state = &quot;G&quot;,
                  ylims=(1e-5, 10),
                  alpha_start = 5,
                  alpha_label_position = (8.5, 5),
                  beta_label_position = (22, 5),
                  gamma_label_position = (60, 5),
                  axis = (; title = &quot;FFT with no window&quot;))

powerspectrumplot(fig[1,2], msn, sol; state = &quot;G&quot;,
                  method=welch_pgram, window=hanning,
                  ylims=(1e-5, 10),
                  alpha_start = 5,
                  alpha_label_position = (8.5, 5),
                  beta_label_position = (22, 5),
                  gamma_label_position = (60, 5),
                  axis = (; title = &quot;Welch&#39;s method + Hanning window&quot;))
fig</code></pre><img src="bdc2fc11.png" alt="Example block output"/><p>We can also run multiple simulations in parallel and compute the average power spectrum</p><pre><code class="language-julia hljs">ens_prob = EnsembleProblem(prob)
ens_sol = solve(ens_prob, RKMil(); dt=dt, saveat=dt, trajectories=3, abstol = 1e-2, reltol = 1e-2);

powerspectrumplot(msn, ens_sol; state = &quot;G&quot;,
                  method=welch_pgram, window=hanning,
                  ylims=(1e-5, 10),
                  alpha_start = 8,
                  alpha_label_position = (8.5, 4),
                  beta_label_position = (22, 4),
                  gamma_label_position = (60, 4),
                  axis = (; title = &quot;Welch&#39;s method + Hanning window + Ensemble&quot;))</code></pre><img src="2586a447.png" alt="Example block output"/><h2 id="Core-striatal-network:-MSN-FSI"><a class="docs-heading-anchor" href="#Core-striatal-network:-MSN-FSI">Core striatal network: MSN + FSI</a><a id="Core-striatal-network:-MSN-FSI-1"></a><a class="docs-heading-anchor-permalink" href="#Core-striatal-network:-MSN-FSI" title="Permalink"></a></h2><p>Now we&#39;ll add Fast-Spiking Interneurons (FSIs) to our model</p><pre><code class="language-julia hljs">global_ns = :g ## global name for the circuit. All components should be inside this namespace.

N_FSI = 50 ## number of Fast Spiking Interneurons
@named msn = Striatum_MSN_Adam(namespace=global_ns, N_inhib = N_MSN)
@named fsi = Striatum_FSI_Adam(namespace=global_ns, N_inhib = N_FSI)

assembly = [msn, fsi]

ḡ_FSI_MSN = 0.6 ## maximal conductance for FSI to MSN synapses [mS/cm^-2]
density_FSI_MSN = 0.15 ## fraction of FSIs connecting to the MSN population
weight_FSI_MSN = ḡ_FSI_MSN / (N_FSI * density_FSI_MSN) ## normalized synaptic weight

g = MetaDiGraph()
add_blox!.(Ref(g), assembly)
add_edge!(g, 2, 1, Dict(:weight =&gt; weight_FSI_MSN, :density =&gt; density_FSI_MSN))

@named sys = system_from_graph(g)
prob = SDEProblem(sys, [], tspan, [])
ens_prob = EnsembleProblem(prob)
ens_sol = solve(ens_prob, RKMil(); dt=dt, saveat=dt, trajectories=3, abstol = 1e-2, reltol = 1e-2);</code></pre><p>Detect spikes and compute firing rates</p><pre><code class="language-julia hljs">spikes_msn = detect_spikes(msn, ens_sol[1]; threshold=-35)
t, fr_msn = mean_firing_rate(spikes_msn, ens_sol[1])

spikes_fsi = detect_spikes(fsi, ens_sol[1]; threshold=-25)
t, fr_fsi = mean_firing_rate(spikes_fsi, ens_sol[1])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(0.0:2000.0:2000.0, [10.91])</code></pre><p>Let&#39;s see their raster plots and power spectra</p><pre><code class="language-julia hljs">fig = Figure(size = (1000, 800))
rasterplot(fig[1,1], msn, ens_sol[1], threshold = -35.0, axis = (; title = &quot;MSN - Mean Firing Rate: $(round(fr_msn[1], digits=2)) spikes/s&quot;))
rasterplot(fig[1,2], fsi, ens_sol[1], threshold = -35.0, axis = (; title = &quot;FSI - Mean Firing Rate: $(round(fr_fsi[1], digits=2)) spikes/s&quot;))

powerspectrumplot(fig[2,1], msn, ens_sol; state = &quot;G&quot;,
                  method=welch_pgram, window=hanning,
                  ylims=(1e-5, 10),
                  xlims=(8, 100),
                  alpha_label_position = (8.5, 3),
                  beta_label_position = (22, 3),
                  gamma_label_position = (60, 3))

powerspectrumplot(fig[2,2], fsi, ens_sol; state = &quot;G&quot;,
                  method=welch_pgram, window=hanning,
                  ylims=(1e-5, 10),
                  xlims=(8, 100),
                  alpha_label_position = (8.5, 3),
                  beta_label_position = (22, 3),
                  gamma_label_position = (60, 3))
fig</code></pre><img src="77f797ef.png" alt="Example block output"/><p>FSIs exhibit a peak in gamma frequencies. Their inhibition onto MSNs suppresses the low beta-band activity seen in isolated MSN populations, without reducing MSN firing rates. This spectral shift reflects a change in MSN spiking dynamics under FSI influence, rather than a decrease in overall activity.</p><h2 id="Full-basal-ganglia-model-in-baseline-condition"><a class="docs-heading-anchor" href="#Full-basal-ganglia-model-in-baseline-condition">Full basal ganglia model in baseline condition</a><a id="Full-basal-ganglia-model-in-baseline-condition-1"></a><a class="docs-heading-anchor-permalink" href="#Full-basal-ganglia-model-in-baseline-condition" title="Permalink"></a></h2><p>Now we&#39;ll add the GPe and STN to complete the full basal ganglia model</p><pre><code class="language-julia hljs">N_GPe = 80 ## number of GPe neurons
N_STN = 40 ## number of STN neurons

@named gpe = GPe_Adam(namespace=global_ns, N_inhib = N_GPe)
@named stn = STN_Adam(namespace=global_ns, N_exci = N_STN)

assembly = [msn, fsi, gpe, stn]

ḡ_MSN_GPe = 2.5 ## maximal conductance for MSN to GPe synapses [mS/cm^-2]
ḡ_GPe_STN = 0.3 ## maximal conductance for GPe to STN synapses [mS/cm^-2]
ḡ_STN_FSI = 0.165 ## maximal conductance for STN to FSI synapses [mS/cm^-2]

density_MSN_GPe = 0.33 ## fraction of MSNs connecting to the GPe population
density_GPe_STN = 0.05 ## fraction of GPe neurons connecting to the STN population
density_STN_FSI = 0.1 ## fraction of STN neurons connecting to the FSI population

weight_MSN_GPe = ḡ_MSN_GPe / (N_MSN * density_MSN_GPe)
weight_GPe_STN = ḡ_GPe_STN / (N_GPe * density_GPe_STN)
weight_STN_FSI = ḡ_STN_FSI / (N_STN * density_STN_FSI)

g = MetaDiGraph()
add_blox!.(Ref(g), assembly)
add_edge!(g, 1, 3, Dict(:weight =&gt; weight_MSN_GPe, :density =&gt; density_MSN_GPe))
add_edge!(g, 2, 1, Dict(:weight =&gt; weight_FSI_MSN, :density =&gt; density_FSI_MSN))
add_edge!(g, 3, 4, Dict(:weight =&gt; weight_GPe_STN, :density =&gt; density_GPe_STN))
add_edge!(g, 4, 2, Dict(:weight =&gt; weight_STN_FSI, :density =&gt; density_STN_FSI))

@named sys = system_from_graph(g)
prob = SDEProblem(sys, [], tspan, [])
ens_prob = EnsembleProblem(prob)
ens_sol = solve(ens_prob, RKMil(); dt=dt, saveat=dt, trajectories=3, abstol = 1e-2, reltol = 1e-2);</code></pre><p>Compute and plot power spectra for all components</p><pre><code class="language-julia hljs">fig = Figure(size = (1500, 600))

powerspectrumplot(fig[1,1], msn, ens_sol; state = &quot;G&quot;,
                  method=welch_pgram, window=hanning,
                  ylims=(1e-5, 10),
                  alpha_label_position = (8.5, 2),
                  beta_label_position = (22, 2),
                  gamma_label_position = (60, 2),
                  axis = (; title = &quot;MSN (Baseline)&quot;))

powerspectrumplot(fig[1,2], fsi, ens_sol; state = &quot;G&quot;,
                  method=welch_pgram, window=hanning,
                  ylims=(1e-5, 10),
                  alpha_label_position = (8.5, 2),
                  beta_label_position = (22, 2),
                  gamma_label_position = (60, 2),
                  axis = (; title = &quot;FSI (Baseline)&quot;))

powerspectrumplot(fig[1,3], gpe, ens_sol; state = &quot;G&quot;,
                  method=welch_pgram, window=hanning,
                  ylims=(1e-5, 10),
                  alpha_label_position = (8.5, 2),
                  beta_label_position = (22, 2),
                  gamma_label_position = (60, 2),
                  axis = (; title = &quot;GPe (Baseline)&quot;))

powerspectrumplot(fig[1,4], stn, ens_sol; state = &quot;G&quot;,
                  method=welch_pgram, window=hanning,
                  ylims=(1e-5, 10),
                  alpha_label_position = (8.5, 2),
                  beta_label_position = (22, 2),
                  gamma_label_position = (60, 2),
                  axis = (; title = &quot;STN (Baseline)&quot;))

fig</code></pre><img src="82f9b771.png" alt="Example block output"/><h2 id="Full-basal-ganglia-model-in-Parkinson&#39;s-condition"><a class="docs-heading-anchor" href="#Full-basal-ganglia-model-in-Parkinson&#39;s-condition">Full basal ganglia model in Parkinson&#39;s condition</a><a id="Full-basal-ganglia-model-in-Parkinson&#39;s-condition-1"></a><a class="docs-heading-anchor-permalink" href="#Full-basal-ganglia-model-in-Parkinson&#39;s-condition" title="Permalink"></a></h2><p>Finally, we&#39;ll adjust the model parameters to simulate Parkinson&#39;s disease conditions</p><p><img src="../../assets/basal_ganglia_parkinson.jpg" alt="Full basal ganglia model in Parkinsonian conditions"/></p><p>The key changes from baseline to Parkinsonian conditions are:</p><ol><li><p>For MSNs:</p><ul><li>Increased background excitation (<code>I_bg</code>) to 1.2519 μA·cm<span>$^{-2}$</span></li><li>Decreased maximal conductance for M-current (<code>G_M</code>) to 1.2 mS·cm<span>$^{-2}$</span></li></ul></li><li><p>For FSIs:</p><ul><li>Decreased background excitation (<code>I_bg</code>) to 4.511 μA·cm<span>$^{-2}$</span></li><li>Decreased maximal conductance of FSI-MSN projection (<code>ḡ_FSI_MSN</code>) by 20% to 0.48 mS·cm<span>$^{-2}$</span>, due to increased cholinergic tone</li><li>Decreased maximal conductance of FSI-FSI projection (<code>weight</code>) to 0.2 mS·cm<span>$^{-2}$</span></li><li>Decreased electrical conductance (<code>g_elec</code>) to 0.075</li></ul></li></ol><p>These changes reflect the loss of dopamine and increase in cholinergic tone characteristic of Parkinson&#39;s disease.</p><p>Create bloxs with Parkinsonian parameters</p><pre><code class="language-julia hljs">@named msn = Striatum_MSN_Adam(namespace=global_ns, N_inhib = N_MSN, I_bg = 1.2519*ones(N_MSN), G_M = 1.2)
@named fsi = Striatum_FSI_Adam(namespace=global_ns, N_inhib = N_FSI, I_bg = 4.511*ones(N_FSI), weight = 0.2, g_weight = 0.075)

assembly = [msn, fsi, gpe, stn]

ḡ_FSI_MSN = 0.48 ## decreased maximal conductance of FSI-MSN projection [mS/cm^-2]
weight_FSI_MSN = ḡ_FSI_MSN / (N_FSI * density_FSI_MSN) ## normalized synaptic weight

g = MetaDiGraph()
add_blox!.(Ref(g), assembly)
add_edge!(g, 2, 1, Dict(:weight =&gt; weight_FSI_MSN, :density =&gt; density_FSI_MSN))
add_edge!(g, 1, 3, Dict(:weight =&gt; weight_MSN_GPe, :density =&gt; density_MSN_GPe))
add_edge!(g, 3, 4, Dict(:weight =&gt; weight_GPe_STN, :density =&gt; density_GPe_STN))
add_edge!(g, 4, 2, Dict(:weight =&gt; weight_STN_FSI, :density =&gt; density_STN_FSI))

@named sys = system_from_graph(g)

prob = SDEProblem(sys, [], tspan, [])
ens_prob = EnsembleProblem(prob)
ens_sol = solve(ens_prob, RKMil(); dt=dt, saveat=dt, trajectories=3, abstol = 1e-2, reltol = 1e-2);</code></pre><p>Compute and compare power spectra for all neural populations in Parkinsonian condition against their counterparts in baseline conditions.</p><pre><code class="language-julia hljs">powerspectrumplot(fig[2,1], msn, ens_sol; state = &quot;G&quot;,
                  method=welch_pgram, window=hanning,
                  ylims=(1e-5, 10),
                  alpha_label_position = (8.5, 2),
                  beta_label_position = (22, 2),
                  gamma_label_position = (60, 2),
                  axis = (; title = &quot;MSN (PD)&quot;))

powerspectrumplot(fig[2,2], fsi, ens_sol; state = &quot;G&quot;,
                  method=welch_pgram, window=hanning,
                  ylims=(1e-5, 10),
                  alpha_label_position = (8.5, 2),
                  beta_label_position = (22, 2),
                  gamma_label_position = (60, 2),
                  axis = (; title = &quot;FSI (PD)&quot;))

powerspectrumplot(fig[2,3], gpe, ens_sol; state = &quot;G&quot;,
                  method=welch_pgram, window=hanning,
                  ylims=(1e-5, 10),
                  alpha_start = 5,
                  alpha_label_position = (8.5, 2),
                  beta_label_position = (22, 2),
                  gamma_label_position = (60, 2),
                  axis = (; title = &quot;GPe (PD)&quot;))

powerspectrumplot(fig[2,4], stn, ens_sol; state = &quot;G&quot;,
                  method=welch_pgram, window=hanning,
                  ylims=(1e-5, 10),
                  alpha_label_position = (8.5, 2),
                  beta_label_position = (22, 2),
                  gamma_label_position = (60, 2),
                  axis = (; title = &quot;STN (PD)&quot;))

fig</code></pre><img src="0b8b81f7.png" alt="Example block output"/><p>We see the emergence of strong beta oscillations in the Parkinsonian condition compared to the baseline condition for all neural populations. This aligns with the findings of Adam et al. and reflects the pathological synchrony observed in Parkinson&#39;s disease.</p><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><p><a href="https://doi.org/10.1073/pnas.2120808119">Adam, Elie M., et al. &quot;Deep brain stimulation in the subthalamic nucleus for Parkinson&#39;s disease can restore dynamics of striatal networks.&quot; Proceedings of the National Academy of Sciences 119.19 (2022): e2120808119.</a></p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../ping_network/">« Pyramidal-Interneuron Gamma network</a><a class="docs-footer-nextpage" href="../spectralDCM/">Spectral Dynamic Causal Modeling Tutorial »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Tuesday 8 October 2024 09:10">Tuesday 8 October 2024</span>. Using Julia version 1.11.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
