<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Resting state simulation using neural mass models · Neuroblox</title><meta name="title" content="Resting state simulation using neural mass models · Neuroblox"/><meta property="og:title" content="Resting state simulation using neural mass models · Neuroblox"/><meta property="twitter:title" content="Resting state simulation using neural mass models · Neuroblox"/><meta name="description" content="Documentation for Neuroblox."/><meta property="og:description" content="Documentation for Neuroblox."/><meta property="twitter:description" content="Documentation for Neuroblox."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="Neuroblox logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Neuroblox</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Neuroblox</a></li><li><a class="tocitem" href="../../getting_started/">Getting Started</a></li><li><span class="tocitem">Tutorials</span><ul><li class="is-active"><a class="tocitem" href>Resting state simulation using neural mass models</a></li><li><a class="tocitem" href="../parkinsons/">Building a model of Parkinson&#39;s disease using Neural Mass models</a></li><li><a class="tocitem" href="../neural_assembly/">Tutorial on bottom-up approach to building a neural assembly</a></li></ul></li><li><a class="tocitem" href="../../api/">API</a></li><li><a class="tocitem" href="../../release_notes/">Release Notes</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Resting state simulation using neural mass models</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Resting state simulation using neural mass models</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Neuroblox/Neuroblox.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Neuroblox/Neuroblox.jl/blob/master/docs/src/tutorials/resting_state.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Resting-state-simulation-using-neural-mass-models"><a class="docs-heading-anchor" href="#Resting-state-simulation-using-neural-mass-models">Resting state simulation using neural mass models</a><a id="Resting-state-simulation-using-neural-mass-models-1"></a><a class="docs-heading-anchor-permalink" href="#Resting-state-simulation-using-neural-mass-models" title="Permalink"></a></h1><p>This tutorial will introduce you to simulating resting state brain dynamics using Neuroblox. We will be using the FitzHugh-Nagumo model as a building block. The FitzHugh-Nagumo model is described by the follwoing equations:</p><p class="math-container">\[       \begin{align}
       \dot{V} &amp;= d \, \tau (-f V^3 + e V^2 + \alpha W - \gamma I_{c} + \sigma w(t) ) \\
       \dot{W} &amp;= \dfrac{d}{\tau}\,\,(b V - \beta W + a + \sigma w(t) )
       \end{align}\]</p><p>We start by building the resting state circuit from individual Generic2dOscillator Blox</p><pre><code class="language-julia hljs">using Neuroblox
using CSV
using DataFrames
using DifferentialEquations
using Random
using CairoMakie
using Statistics
using HypothesisTests

# read connection matrix from file
weights = CSV.read(&quot;../data/weights.csv&quot;,DataFrame)
region_names = names(weights)

wm = Array(weights) ## transform the weights into a matrix
N_bloxs = size(wm)[1] ## number of blox components

# create an array of neural mass models
blocks = [Generic2dOscillator(name=Symbol(region_names[i]),bn=sqrt(5e-4)) for i in 1:N_bloxs]

# add neural mass models to Graph and connect using the connection matrix
g = MetaDiGraph()
add_blox!.(Ref(g), blocks)
create_adjacency_edges!(g, wm)

@named sys = system_from_graph(g);</code></pre><p>To solve the system, we first create an Stochastic Differential Equation Problem and then solve it using a EulerHeun solver. The solution is saved every 0.5 ms. The unit of time in Neuroblox is 1 ms.</p><pre><code class="language-julia hljs">prob = SDEProblem(sys,rand(-2:0.1:4,76*2), (0.0, 6e5), [])
sol = solve(prob, EulerHeun(), dt=0.5, saveat=5)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: 1st order linear
t: 120001-element Vector{Float64}:
      0.0
      5.0
     10.0
     15.0
     20.0
     25.0
     30.0
     35.0
     40.0
     45.0
      ⋮
 599960.0
 599965.0
 599970.0
 599975.0
 599980.0
 599985.0
 599990.0
 599995.0
 600000.0
u: 120001-element Vector{Vector{Float64}}:
 [3.9, 0.0, 0.6, 3.3, 1.8, -1.7, 0.9, 2.3, 3.6, 2.4  …  -1.6, 1.5, -1.7, -0.9, 2.8, -0.1, 3.3, 1.2, -1.9, 0.6]
 [2.96320928362564, -3.3763163466171537, 0.600801477906884, 2.1663538235763813, 1.6086834958461118, -3.3301540430775605, 0.6985101046690007, 1.1784099144463829, 3.0030520064212842, -1.1409231927624655  …  -0.9910011231910058, 2.369532469777486, -1.2327298388080397, 0.39326556695858694, 2.6852865834714996, -2.920948956058629, 2.8058422976288173, -2.066620065874611, -0.9755844143139444, 1.6394920506780648]
 [2.421649590093881, -5.796985556517355, 0.5366668135146665, 1.3670683089279285, 1.2601826402494216, -4.50096246341402, 0.5076800738190843, 0.33844503939791837, 2.5792360417077735, -3.7552676765547806  …  -0.7132613812397973, 2.73046837267687, -0.9715484398556876, 1.2243445170748315, 2.373283294269637, -5.206969597469625, 2.4005097614691495, -4.452057012022641, -0.5572993153199379, 2.026817802713703]
 [1.9280348503176137, -7.475696441752482, 0.4252766693128228, 0.5929675028298236, 0.8268026245610554, -5.3120849792495015, 0.15459546262287732, -0.22426289606434546, 2.2189046906401804, -5.834582049931582  …  -0.48860495052730185, 2.9033106168058747, -0.7895132253559987, 1.6889451258380914, 2.101623927240723, -7.100141929781854, 1.878246675725951, -6.172436013710076, -0.2886858280409903, 2.066749719344732]
 [1.354743777985613, -8.561341465563924, 0.22151858782595288, 0.05134560837435573, 0.2147687774892037, -5.4927031243479245, -0.126462579107191, -0.5090704897970753, 1.7734796165574593, -7.494773221842823  …  -0.2867807312600785, 2.8792917715978144, -0.6070663539100061, 2.063843155122225, 1.677070588203529, -8.346899125844955, 1.3765920997246464, -7.350429631402658, -0.11330689891087145, 1.9121308697879245]
 [0.5595589259348631, -8.841039604139363, 0.05033890949213955, -0.3110378111654899, -0.4438811147048044, -5.040335090945263, -0.3139629862227729, -0.3871289881919709, 1.2382799293606577, -8.494841378605816  …  -0.13683425665195112, 2.714659543292294, -0.4140671181438311, 2.142139992560308, 0.9408339290531696, -9.057273241595285, 0.6234343062761036, -7.765870523368101, 0.12115295991377861, 1.7347098594863155]
 [-0.3198889381928144, -8.261424105579698, -0.09445596371476034, -0.439110352152179, -0.7609222711419016, -4.153630547036567, -0.2590843084402239, -0.2814376865575928, 0.48485940069444633, -8.730451928550139  …  0.08220268593714702, 2.214929970420804, -0.20843769712767007, 2.0558541286594885, 0.10539591241262777, -8.863062219223083, -0.19104919676122253, -7.482251214821201, 0.3139787896746658, 1.1386483476345082]
 [-0.9041165185828293, -7.0694430287201335, -0.07348182076971085, -0.571358439235013, -0.8149151329392142, -3.218501850457482, -0.20002705803613685, -0.2129499136471648, -0.31324773730024524, -8.115078863460104  …  0.36860934272321194, 1.5988545576024051, 0.0159226539701761, 1.7764915576637519, -0.6324183155494236, -7.96813412457656, -0.6729584658828236, -6.477950897466394, 0.4159238714412004, 0.551970319929161]
 [-1.0582737545031677, -5.575025696914503, -0.025491542284641906, -0.696609573957812, -0.7955412855446905, -2.3484443100264336, -0.01021615136993984, -0.25673569781517236, -0.7886703454594811, -6.943113748217258  …  0.5892885735334358, 0.8355233879598113, 0.25776311702159244, 1.3055912828986656, -1.0351710675661308, -6.56202053257975, -0.9369344375468378, -5.267023089633087, 0.5275534136871729, -0.2336409295498036]
 [-1.0712209498791996, -4.15967399031542, -0.032133545833834536, -0.88670414086152, -0.6427466088744501, -1.6506926394243777, 0.12574859728280482, -0.48101043940943167, -1.0069223278461537, -5.6709387656744115  …  0.7274081625198383, -0.03287051272059361, 0.46575134011753244, 0.5720015469155586, -1.0810079932293721, -4.97605378628208, -0.8921379220733078, -3.967256394017372, 0.5919701104807887, -0.9412749849930546]
 ⋮
 [-0.06880622216817715, -0.6223370301075316, -0.22477422089063603, -0.38468260280065447, -0.149986548640367, -0.5705963619368687, -0.2042378123656652, -0.5274180937484193, -0.09198250226895993, -0.8316142071755559  …  -0.029685589804395153, -0.827102206660467, -0.2185823609091144, -0.3995312522345728, -0.2566608806505607, -0.3125213234394792, -0.2938173903655974, -0.1290368649839531, -0.2491706612823608, 0.06514730249554451]
 [-0.11881280120889287, -0.6637258660672126, -0.1810754520770969, -0.39686579154917223, -0.17862503377511674, -0.5694767907150098, -0.22341464818040743, -0.5384851278731898, -0.1387190213492659, -0.8322207434213477  …  0.01861241437453793, -0.8585264749903307, -0.10726359270574981, -0.31286996619124063, -0.21094377911790335, -0.22964255638736125, -0.2126886520499139, -0.10874831539749208, -0.2745204008547312, 0.13032895482315673]
 [-0.16174722382604495, -0.6960701033854644, -0.18624653901831564, -0.3049762369709816, -0.17735148833963882, -0.4551934827582494, -0.1810382823415284, -0.4976297002894177, -0.16130287128689944, -0.816707736864044  …  -0.020682816197392047, -0.9436876398128362, -0.22230586782368933, -0.31738587283702924, -0.20440732528173058, -0.12304728761674709, -0.15610459296592225, -0.08900935986652583, -0.23889355480865995, 0.06073542926028175]
 [-0.1724048542435128, -0.6966719573664902, -0.16187525041526676, -0.2371540950353227, -0.1866617179976776, -0.46937744980086227, -0.06872873665112274, -0.5352188199728661, -0.22985397725877868, -0.711375136597287  …  -0.05708485265931356, -0.9827966862475617, -0.08334412144719933, -0.2784158270747132, -0.20904208808965502, -0.15889832424552489, -0.15186654682499334, -0.17658783590059596, -0.25101576418915406, 0.1319996900735268]
 [-0.1499687284272067, -0.6815598996154656, -0.12734395365284382, -0.37415439231193764, -0.25784546638205896, -0.4138068912090315, -0.01800171365646879, -0.7191918199681193, -0.19832410772430326, -0.6653308721505358  …  -0.11360579570522343, -1.0064481003008265, -0.013376782135323706, -0.3806961675562033, -0.2075239195248565, -0.20982838761724817, -0.11541642433535121, -0.20684415435328565, -0.26139539295651154, 0.17101084624958598]
 [-0.06958399322181863, -0.7046900197252408, -0.1848526891663013, -0.40173782583675904, -0.21044458172629776, -0.27533036179787157, -0.0569739594951466, -0.765171823377276, -0.21969626938078157, -0.5268793062384889  …  -0.26421460088990384, -0.8281910811788238, 0.021851692018506043, -0.6062042643907848, -0.1836145482949684, -0.1753608668965423, -0.16054332899903087, -0.1905374532541005, -0.17905608173822618, 0.12046040661613074]
 [-0.07647420987497305, -0.8228574575710053, -0.1530856409287016, -0.36299097005881653, -0.16058674454204175, -0.22488795800519892, -0.07427932934589135, -0.7864160600295883, -0.26677784868988685, -0.464416323571454  …  -0.2337389662664601, -0.6627434743362872, -0.0271818359899199, -0.7528930097906736, -0.15395585891544558, -0.20126786679198713, -0.13049020327441335, -0.20455271997862037, -0.16495608294448363, 0.13306417549876903]
 [-0.12718898091461056, -0.7938479009484167, -0.18007301746100154, -0.3361191596766761, -0.209652368950557, -0.23347232812484608, -0.10430514349148498, -0.8129381629447266, -0.25701130402055217, -0.38213841525045567  …  -0.18962407839413375, -0.5208399627241422, -0.06945687729290707, -0.872200824658524, -0.2278734274686394, -0.21935243395762946, -0.0774248861279455, -0.21142537080233392, -0.18854962820860804, 0.1133664750261262]
 [-0.20447437923189685, -0.6966565103502483, -0.2807723228897548, -0.26320271512309884, -0.20871072420940517, -0.1296071798540537, -0.03314040941792231, -0.9822380114203105, -0.23586660320373767, -0.3313950498511689  …  -0.22992978603272285, -0.5424526528656598, -0.11865133002835399, -0.8197501092110995, -0.23379127340916653, -0.19668366771617055, -0.08854196773797586, -0.34307289067473623, -0.21088323191601857, 0.14667643796254579]</code></pre><p>Let us plot the voltage potential of the first couple of components</p><pre><code class="language-julia hljs">v1 = voltage_timeseries(blocks[1], sol)
v2 = voltage_timeseries(blocks[2], sol)

fig = Figure()
ax = Axis(fig[1,1]; xlabel = &quot;time (ms)&quot;, ylabel = &quot;Potential&quot;)
lines!(ax, sol.t, v1)
lines!(ax, sol.t, v2)
xlims!(ax, (0, 1000)) ## limit the x-axis to the first second of simulation
fig</code></pre><img src="53e028e7.png" alt="Example block output"/><p>To evaluate the connectivity of our simulated resting state network, we calculate the statistically significant correlations</p><pre><code class="language-julia hljs">cs = []
for i in 1:Int((length(sol.t)-1)/1000)-1
    solv = Array(sol[1:2:end,(i-1)*1000+1:(i*1000)])&#39;
    push!(cs,cor(solv))
end
css = stack(cs)

p = zeros(76,76)
for i in 1:76
    for j in 1:76
        p[i,j] = pvalue(OneSampleTTest(css[i,j,:]))
    end
end

heatmap(log10.(p) .* (p .&lt; 0.05))</code></pre><img src="48dd94e3.png" alt="Example block output"/><p>Fig.: log10(p value) displaying statistally significant correlation between time series</p><pre><code class="language-julia hljs">heatmap(wm)</code></pre><img src="97dcf012.png" alt="Example block output"/><p>Fig.: Connection Adjacency Matrix that was used to connect the neural mass models</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../getting_started/">« Getting Started</a><a class="docs-footer-nextpage" href="../parkinsons/">Building a model of Parkinson&#39;s disease using Neural Mass models »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Friday 4 October 2024 07:12">Friday 4 October 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
