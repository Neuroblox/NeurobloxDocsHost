<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Resting state simulation using neural mass models · Neuroblox</title><meta name="title" content="Resting state simulation using neural mass models · Neuroblox"/><meta property="og:title" content="Resting state simulation using neural mass models · Neuroblox"/><meta property="twitter:title" content="Resting state simulation using neural mass models · Neuroblox"/><meta name="description" content="Documentation for Neuroblox."/><meta property="og:description" content="Documentation for Neuroblox."/><meta property="twitter:description" content="Documentation for Neuroblox."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="Neuroblox logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Neuroblox</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Neuroblox</a></li><li><a class="tocitem" href="../../getting_started/">Getting Started</a></li><li><span class="tocitem">Tutorials</span><ul><li class="is-active"><a class="tocitem" href>Resting state simulation using neural mass models</a></li><li><a class="tocitem" href="../parkinsons/">Building a model of Parkinson&#39;s disease using Neural Mass models</a></li><li><a class="tocitem" href="../neural_assembly/">Tutorial on bottom-up approach to building a neural assembly</a></li></ul></li><li><a class="tocitem" href="../../api/">API</a></li><li><a class="tocitem" href="../../release_notes/">Release Notes</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Resting state simulation using neural mass models</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Resting state simulation using neural mass models</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Neuroblox/Neuroblox.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Neuroblox/Neuroblox.jl/blob/master/docs/src/tutorials/resting_state.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Resting-state-simulation-using-neural-mass-models"><a class="docs-heading-anchor" href="#Resting-state-simulation-using-neural-mass-models">Resting state simulation using neural mass models</a><a id="Resting-state-simulation-using-neural-mass-models-1"></a><a class="docs-heading-anchor-permalink" href="#Resting-state-simulation-using-neural-mass-models" title="Permalink"></a></h1><p>This tutorial will introduce you to simulating resting state brain dynamics using Neuroblox. We will be using the FitzHugh-Nagumo model as a building block. The FitzHugh-Nagumo model is described by the follwoing equations:</p><p class="math-container">\[       \begin{align}
       \dot{V} &amp;= d \, \tau (-f V^3 + e V^2 + \alpha W - \gamma I_{c} + \sigma w(t) ) \\
       \dot{W} &amp;= \dfrac{d}{\tau}\,\,(b V - \beta W + a + \sigma w(t) )
       \end{align}\]</p><p>We start by building the resting state circuit from individual Generic2dOscillator Blox</p><pre><code class="language-julia hljs">using Neuroblox
using CSV
using DataFrames
using DifferentialEquations
using Random
using CairoMakie
using Statistics
using HypothesisTests

# read connection matrix from file
weights = CSV.read(&quot;../data/weights.csv&quot;,DataFrame)
region_names = names(weights)

wm = Array(weights) ## transform the weights into a matrix
N_bloxs = size(wm)[1] ## number of blox components

# create an array of neural mass models
blocks = [Generic2dOscillator(name=Symbol(region_names[i]),bn=sqrt(5e-4)) for i in 1:N_bloxs]

# add neural mass models to Graph and connect using the connection matrix
g = MetaDiGraph()
add_blox!.(Ref(g), blocks)
create_adjacency_edges!(g, wm)

@named sys = system_from_graph(g);</code></pre><p>To solve the system, we first create an Stochastic Differential Equation Problem and then solve it using a EulerHeun solver. The solution is saved every 0.5 ms. The unit of time in Neuroblox is 1 ms.</p><pre><code class="language-julia hljs">prob = SDEProblem(sys,rand(-2:0.1:4,76*2), (0.0, 6e5), [])
sol = solve(prob, EulerHeun(), dt=0.5, saveat=5)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: 1st order linear
t: 120001-element Vector{Float64}:
      0.0
      5.0
     10.0
     15.0
     20.0
     25.0
     30.0
     35.0
     40.0
     45.0
      ⋮
 599960.0
 599965.0
 599970.0
 599975.0
 599980.0
 599985.0
 599990.0
 599995.0
 600000.0
u: 120001-element Vector{Vector{Float64}}:
 [-1.5, 2.0, -1.2, 0.0, 3.9, 2.9, 3.6, -1.6, 0.8, -1.1  …  -1.8, 1.1, -1.0, 2.5, 0.6, 0.5, 3.3, 0.0, 3.6, 2.9]
 [-0.9049427682719202, 2.7181910845053046, -0.8545304494508008, 0.7172896327925768, 3.1645524895516512, -0.8501120363461961, 2.825627634390291, -4.648236292142381, 0.42895619689522324, -1.7130581342875542  …  -1.049215053793859, 2.0795630655588546, -0.6969041070433141, 2.832646955634023, 0.5816097129620579, -0.2736214507163699, 2.7451336094192227, -3.004858218905871, 3.203823502675853, -0.768986534153463]
 [-0.6070330681696512, 2.939303293323566, -0.7168996038630762, 1.2051041193874235, 2.7514401086035503, -3.7495365385400197, 2.261781483804333, -6.719241458458636, -0.06681331585136371, -1.975712413867664  …  -0.7643236524463447, 2.4698519139179296, -0.5412467165135936, 2.8703220297237495, 0.5834187837348649, -1.0235698406567737, 2.2673066234818746, -5.2599191691769756, 2.9116617623829826, -3.718997430898011]
 [-0.3181959890059698, 2.93329334707831, -0.5146917258386451, 1.5197481159146884, 2.4410766657175507, -5.980333602761131, 1.6809999899596448, -8.205576818584367, -0.4325398603230819, -1.7058881948742686  …  -0.5391052917873375, 2.6721503165019573, -0.4106232733206993, 2.7587576406537786, 0.41468194171262873, -1.4926776882004908, 1.7894729320708813, -6.788196159037374, 2.577409657486436, -6.191994963720867]
 [-0.10276796197429254, 2.66877364018018, -0.3199492120151551, 1.5303765878048066, 1.996800668034991, -7.715054221279207, 0.9243930136659135, -8.900034032627788, -0.6197355916557024, -1.1868482731954437  …  -0.34864478991464154, 2.661858243640565, -0.19432188406111187, 2.5557919790319708, 0.09980406418359353, -1.7901143527731118, 1.1925441912206354, -7.793091554547278, 2.157654030942107, -7.98697781231422]
 [0.10546599275613057, 2.199303207922848, -0.24900990353484323, 1.3661709371104769, 1.525869699146243, -8.81280293877805, 0.07181117057771264, -8.708300611558396, -0.688600767357542, -0.604821446598802  …  -0.23790854587682442, 2.472018314342305, 0.10367538481559697, 2.095070269697313, -0.009953204473106231, -1.8433317764870303, 0.41398631993127544, -7.994437441059327, 1.6076694876200066, -9.208516444138102]
 [0.35157318338339777, 1.6070797069444431, -0.020310467096342037, 1.1712943338016897, 0.8453395644437905, -9.25556973599619, -0.7448905528474896, -7.6078824903733375, -0.6226828495404766, -0.12164524990113074  …  -0.015994998295632463, 2.139537644195422, 0.17094984878655545, 1.60855882535703, -0.1316622866189934, -1.8774943654683385, -0.3667996743292499, -7.44341050121849, 0.9744544576715373, -9.711660116525488]
 [0.5289156536954358, 0.792678347418858, 0.06425851089242171, 0.8582894069538105, 0.06868810663734788, -9.009821573589909, -1.0118874543406462, -6.25234555822228, -0.3968998115488703, 0.14365539556974036  …  0.17238867252077736, 1.6921359081410974, 0.250558676592163, 1.0461783281050798, -0.2426438313337648, -1.67582611823347, -0.8729301141365069, -6.3507443736490945, -0.0031509970509123048, -9.452105414545718]
 [0.7304658425857796, -0.09239886295795455, 0.13176918830799914, 0.4725167431416737, -0.6846633697466811, -8.055989371264031, -1.0340039966048493, -4.770818736794088, -0.24114252350878446, 0.21813720761520822  …  0.4227065909157236, 1.0579239825127258, 0.3970787796931579, 0.47664452456270145, -0.22107059443160082, -1.5109665536716976, -0.9637941864249286, -5.118874702488331, -0.8369502610850591, -8.275186887867363]
 [0.911676816691518, -1.0943231695869564, 0.24767461367635824, 0.08032237810486628, -1.0849392905179691, -6.618690775181746, -0.9345461238510353, -3.6229833747031854, 0.0008743614935792388, 0.1334575875173763  …  0.6061273201155593, 0.2897909849458871, 0.5264048697897741, -0.2430040748112885, -0.25313272978462203, -1.2882802983530037, -0.9013151918465498, -3.8450499797961193, -1.169194809959323, -6.717059492761092]
 ⋮
 [-0.23981090597611668, -0.4243396342293392, -0.15066880393912005, -0.5349797615150591, -0.3070938021980382, -0.31602776898615803, -0.11312414487580656, -0.6606841664241558, -0.12924573994006402, -0.9537352210308385  …  -0.10359397617082768, -0.9410678704925378, -0.185570065340533, -0.6957175476276073, -0.06437351487336773, -0.04854912667467688, -0.2046717637696302, -0.5642863690773023, -0.137752839029278, -0.5280137728011863]
 [-0.20814189977968534, -0.4241324824378311, -0.13061590984157487, -0.5495754095150033, -0.2580610276484082, -0.22223595945847294, -0.07942472498783441, -0.7091213681644868, -0.20762398836388427, -0.9050913341624048  …  -0.22819142819986188, -0.8975136399850512, -0.243551456318023, -0.6685199462763785, -0.0585558066117896, -0.1315872492822684, -0.14156647454021296, -0.5554199857119027, -0.13895066486574717, -0.5223583268507354]
 [-0.24464798230725315, -0.32765452331232114, -0.045251975229918154, -0.5737362322948559, -0.23971450731292587, -0.1342874523608672, -0.0959668593142963, -0.6719909880439503, -0.2735841949883443, -0.7774591056725376  …  -0.31371189401359134, -0.754977337322055, -0.3819989887811168, -0.4431344381869182, -0.11195371184219492, -0.19216618329398719, -0.14018422995823837, -0.5695207359503923, -0.2049014758386893, -0.46810712658996273]
 [-0.13247682524699833, -0.28167630876063793, -0.0404632638405891, -0.7236039778720208, -0.21299138190327238, -0.15067334904635363, -0.025054557808758916, -0.7966570564499849, -0.22866215940323864, -0.6279872276319941  …  -0.3508507252093822, -0.5172890700971364, -0.31904309381793305, -0.15419826746500312, -0.21229668965642878, -0.20529482889369133, -0.17585519232093505, -0.5581496049493346, -0.29144547763911827, -0.36875271452124914]
 [-0.1706263983838268, -0.33815128800915145, -0.056744614576252905, -0.7573790891793222, -0.17809997284807574, -0.09414167246339832, -0.10166762679345878, -0.861789138661783, -0.16226949672017313, -0.5518305676600832  …  -0.2899074729260484, -0.27825501038219935, -0.2279935818091464, -0.023556023623869903, -0.24303161135254023, -0.23876984195210554, -0.15195306903123534, -0.5729455952789699, -0.243516467383399, -0.16712129255444788]
 [-0.18066580409619729, -0.3597314379109583, -0.14769453188780957, -0.8042213279643456, -0.175188097638398, -0.10234795999931434, -0.10540856812349315, -0.8826733396487613, -0.22039685908509363, -0.5091165365038258  …  -0.21813534159056844, -0.19110512631317889, -0.17961375091663684, 0.053587810013653744, -0.30051886372106795, -0.16659140248286178, -0.20784173847694834, -0.4813777735815788, -0.24120025330921574, -0.10149525498285919]
 [-0.20489504464771294, -0.3526173458276954, -0.19170757525493085, -0.8486566263497299, -0.17403398657811864, -0.10148760935186152, -0.1427916088620722, -0.8342551896021623, -0.21453779635782047, -0.47789558155649847  …  -0.1298472485294454, -0.24336674216643547, -0.10437600435153704, -0.029708935340131897, -0.26172162446593056, -0.10856449571642818, -0.18735180793112183, -0.4239840748283367, -0.2789545689386743, -0.01961981122438519]
 [-0.1943935782313504, -0.26868771996188806, -0.11253812312314201, -0.8243994125589764, -0.12233532554920784, -0.20928756686837807, -0.1919580012616965, -0.7877475774402161, -0.229584836047951, -0.3963887968104803  …  -0.04643191059645412, -0.27648681821442594, -0.02688734627713494, -0.240164867036249, -0.19313682246965705, 0.008837171583812795, -0.11447177904605554, -0.40750876604388536, -0.20056532935938057, -0.0077508236448387904]
 [-0.17028307313895014, -0.2037296921678253, -0.17370239852521582, -0.792333395102661, -0.1384011097438284, -0.29077617081775, -0.20546741263286583, -0.6639804864446065, -0.24158675492998233, -0.3273176272409287  …  -0.04483979541898384, -0.3851585295108124, 0.01422638351789109, -0.3801331650856603, -0.2260876669850937, -0.016458650409278196, -0.15269461563196657, -0.4886036200540633, -0.20895047515142057, -0.030517417474738837]</code></pre><p>Let us plot the voltage potential of the first couple of components</p><pre><code class="language-julia hljs">v1 = voltage_timeseries(blocks[1], sol)
v2 = voltage_timeseries(blocks[2], sol)

fig = Figure()
ax = Axis(fig[1,1]; xlabel = &quot;time (ms)&quot;, ylabel = &quot;Potential&quot;)
lines!(ax, sol.t, v1)
lines!(ax, sol.t, v2)
xlims!(ax, (0, 1000)) ## limit the x-axis to the first second of simulation
fig</code></pre><img src="5e1bc675.png" alt="Example block output"/><p>To evaluate the connectivity of our simulated resting state network, we calculate the statistically significant correlations</p><pre><code class="language-julia hljs">cs = []
for i in 1:Int((length(sol.t)-1)/1000)-1
    solv = Array(sol[1:2:end,(i-1)*1000+1:(i*1000)])&#39;
    push!(cs,cor(solv))
end
css = stack(cs)

p = zeros(76,76)
for i in 1:76
    for j in 1:76
        p[i,j] = pvalue(OneSampleTTest(css[i,j,:]))
    end
end

heatmap(log10.(p) .* (p .&lt; 0.05))</code></pre><img src="554970cd.png" alt="Example block output"/><p>Fig.: log10(p value) displaying statistally significant correlation between time series</p><pre><code class="language-julia hljs">heatmap(wm)</code></pre><img src="97dcf012.png" alt="Example block output"/><p>Fig.: Connection Adjacency Matrix that was used to connect the neural mass models</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../getting_started/">« Getting Started</a><a class="docs-footer-nextpage" href="../parkinsons/">Building a model of Parkinson&#39;s disease using Neural Mass models »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Wednesday 2 October 2024 15:57">Wednesday 2 October 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
