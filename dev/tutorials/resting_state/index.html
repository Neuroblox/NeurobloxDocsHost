<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Resting state simulation using neural mass models · Neuroblox</title><meta name="title" content="Resting state simulation using neural mass models · Neuroblox"/><meta property="og:title" content="Resting state simulation using neural mass models · Neuroblox"/><meta property="twitter:title" content="Resting state simulation using neural mass models · Neuroblox"/><meta name="description" content="Documentation for Neuroblox."/><meta property="og:description" content="Documentation for Neuroblox."/><meta property="twitter:description" content="Documentation for Neuroblox."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="Neuroblox logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Neuroblox</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Neuroblox</a></li><li><a class="tocitem" href="../../getting_started/">Getting Started</a></li><li><span class="tocitem">Tutorials</span><ul><li class="is-active"><a class="tocitem" href>Resting state simulation using neural mass models</a></li><li><a class="tocitem" href="../parkinsons/">Building a model of Parkinson&#39;s disease using Neural Mass models</a></li><li><a class="tocitem" href="../neural_assembly/">Tutorial on bottom-up approach to building a neural assembly</a></li></ul></li><li><a class="tocitem" href="../../api/">API</a></li><li><a class="tocitem" href="../../release_notes/">Release Notes</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Resting state simulation using neural mass models</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Resting state simulation using neural mass models</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Neuroblox/Neuroblox.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Neuroblox/Neuroblox.jl/blob/master/docs/src/tutorials/resting_state.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Resting-state-simulation-using-neural-mass-models"><a class="docs-heading-anchor" href="#Resting-state-simulation-using-neural-mass-models">Resting state simulation using neural mass models</a><a id="Resting-state-simulation-using-neural-mass-models-1"></a><a class="docs-heading-anchor-permalink" href="#Resting-state-simulation-using-neural-mass-models" title="Permalink"></a></h1><p>This tutorial will introduce you to simulating resting state brain dynamics using Neuroblox. We will be using the FitzHugh-Nagumo model as a building block. The FitzHugh-Nagumo model is described by the follwoing equations:</p><p class="math-container">\[       \begin{align}
       \dot{V} &amp;= d \, \tau (-f V^3 + e V^2 + \alpha W - \gamma I_{c} + \sigma w(t) ) \\
       \dot{W} &amp;= \dfrac{d}{\tau}\,\,(b V - \beta W + a + \sigma w(t) )
       \end{align}\]</p><p>We start by building the resting state circuit from individual Generic2dOscillator Blox</p><pre><code class="language-julia hljs">using Neuroblox
using CSV
using DataFrames
using DifferentialEquations
using Random
using CairoMakie
using Statistics
using HypothesisTests

# read connection matrix from file
weights = CSV.read(&quot;../data/weights.csv&quot;,DataFrame)
region_names = names(weights)

wm = Array(weights) ## transform the weights into a matrix
N_bloxs = size(wm)[1] ## number of blox components

# create an array of neural mass models
blocks = [Generic2dOscillator(name=Symbol(region_names[i]),bn=sqrt(5e-4)) for i in 1:N_bloxs]

# add neural mass models to Graph and connect using the connection matrix
g = MetaDiGraph()
add_blox!.(Ref(g), blocks)
create_adjacency_edges!(g, wm)

@named sys = system_from_graph(g);</code></pre><p>To solve the system, we first create an Stochastic Differential Equation Problem and then solve it using a EulerHeun solver. The solution is saved every 0.5 ms. The unit of time in Neuroblox is 1 ms.</p><pre><code class="language-julia hljs">prob = SDEProblem(sys,rand(-2:0.1:4,76*2), (0.0, 6e5), [])
sol = solve(prob, EulerHeun(), dt=0.5, saveat=5)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: 1st order linear
t: 120001-element Vector{Float64}:
      0.0
      5.0
     10.0
     15.0
     20.0
     25.0
     30.0
     35.0
     40.0
     45.0
      ⋮
 599960.0
 599965.0
 599970.0
 599975.0
 599980.0
 599985.0
 599990.0
 599995.0
 600000.0
u: 120001-element Vector{Vector{Float64}}:
 [2.4, 3.3, 1.5, 3.7, -0.8, 0.1, 1.5, -0.8, 2.6, -0.1  …  0.1, 3.2, 1.7, 2.1, 2.9, 2.5, 1.2, 3.8, -1.6, 2.7]
 [2.581017716315515, 0.29516311835211545, 1.8451097611862006, 1.5759620305962547, -0.6805287167506604, 0.6691086646827572, 1.1093781757543897, -2.246341086215962, 2.4765071660934255, -2.717850836810341  …  0.06060206526983351, 2.5401735040227, 1.9444693701402707, -0.08760372614286849, 2.8695757439821934, -0.6857432434440291, 1.3705590370272427, 2.0593876494657177, -0.8107524146943352, 3.3795109178724814]
 [2.531639315723668, -2.3330362204657016, 2.133361079563471, -0.6905403005947821, -0.5842655022607434, 1.031916905527651, 0.5369199744730434, -2.9970419932050563, 2.1486334189202965, -4.879872545289468  …  0.02632415877855756, 1.9759187539234466, 1.9373834167993031, -2.046888431698266, 2.664647406024388, -3.5097762929134664, 1.4517070478611578, 0.24503484335348122, -0.27624992795950387, 3.42007582015754]
 [2.3508260614629797, -4.6271436429281865, 2.130395323202463, -2.82528489872998, -0.49093551301790234, 1.2687593448646566, -0.05736952647776789, -3.188172255468994, 1.837812171956323, -6.494647688446535  …  -0.04493615732867013, 1.588553807048707, 1.914623851681255, -3.80063467083844, 2.4264604534347223, -5.791917809419465, 1.4601375552347242, -1.2994982153255674, 0.018760569242231837, 3.088874992228439]
 [2.0852869668151266, -6.623347715956165, 1.9677845309502224, -4.631254620825524, -0.2779463060268776, 1.3001928203039252, -0.6300915314924449, -2.798669994409164, 1.2918413846940533, -7.515025573570517  …  -0.06292450411103104, 1.3002257576055127, 1.5498494762788213, -5.272107470313731, 1.9603445153418655, -7.597735282561618, 1.2027923491128016, -2.574748467833628, 0.2003300633006167, 2.486546322923538]
 [1.674690812927233, -8.055449724564012, 1.7664657007641256, -6.2397739809106705, -0.20696786183729798, 1.16013844845869, -0.8447182205091829, -1.9460410445005798, 0.7525816015172205, -7.914772821534219  …  -0.11977000861273727, 1.1331670345657494, 1.0819106925907858, -6.2881091638017, 1.4615832538251778, -8.70770911656107, 0.9606075335735049, -3.542539556412711, 0.4111600369896544, 1.771747024288439]
 [1.183373827303698, -8.935824724326693, 1.502536631559883, -7.3443048700940174, -0.10715257702403974, 1.0694134336277223, -0.7602240344307023, -1.2302735018905377, 0.07922963824082566, -7.731065182765016  …  -0.027379162066527983, 0.8816546093724809, 0.5475047646706069, -6.587764436050452, 0.8657871711233809, -9.225926946079992, 0.6106797846616524, -4.134174501538486, 0.6175071269170926, 0.940347547133699]
 [0.43349280926802036, -8.990885991709346, 1.0939116872487387, -8.071353661650852, 0.050193255263390905, 0.8305557883775135, -0.5653738868676776, -0.6937111304516017, -0.5184608206283636, -6.907134627785044  …  0.033067272410196864, 0.6744866918288279, 0.009478798780284708, -6.378902025414097, 0.08268488998544454, -8.936400953513965, 0.2475516420478002, -4.305539046339896, 0.8699935273826029, -0.023244072181967848]
 [-0.2750606783172811, -8.314159966590612, 0.4306130668066223, -8.17251231906911, 0.21977154678569802, 0.4284382373795246, -0.36137846271459934, -0.4403804074540821, -0.7924497584617408, -5.78128591339225  …  0.11492432924729394, 0.2099933121382412, -0.49608089447910403, -5.619145513231848, -0.6657262791187171, -7.999081892158958, -0.16584471282595953, -4.142349396769139, 1.1004651317747443, -1.2003983377948102]
 [-0.8600206191986352, -7.099763385509367, -0.3172003318322856, -7.560904827360671, 0.24097165139560453, 0.10674438146081867, -0.23946960163046774, -0.33073261546900784, -0.9208482009181668, -4.599039267293512  …  0.2117024868295558, -0.21512492953146475, -0.8245688495364916, -4.6076111366973915, -1.0589105454238001, -6.575615233559249, -0.3857432535165931, -3.566521471568868, 1.1231662982918755, -2.4093107994967453]
 ⋮
 [0.02813543015561813, -0.30267676153594664, -0.21659637723316907, -0.5283659386769426, -0.053195132871790674, -0.6792920626042028, -0.08581477829754272, -0.5474196059552302, -0.08974652981000805, -0.08675092731315885  …  -0.14047638009194688, -0.5909964472271547, -0.19457152645152795, -0.46092590157610436, -0.2294714803314462, 0.24996670183400638, -0.2366939809096632, -0.4477015639135417, -0.19741647680186453, -0.37822938814672846]
 [0.040173558492590564, -0.5407279211316924, -0.22376595402294078, -0.4375063054817259, -0.12173442202924958, -0.6841079862416365, -0.10643582952606594, -0.6215221757518322, -0.06946437824407281, -0.23553684261574948  …  -0.2133197465128291, -0.5313819787820699, -0.14536676078593466, -0.4526696264099976, -0.18353000152939433, 0.1611099205588318, -0.2121799442682443, -0.2532744520210945, -0.13045687502040668, -0.3581902146337978]
 [0.0042302367330761415, -0.6815163489677271, -0.23274854600162942, -0.3650659514455615, -0.11340574867755797, -0.6210626562267162, -0.1349657553918679, -0.6777832580602721, -0.13215031173032485, -0.27357679485043357  …  -0.14315993403767394, -0.44981733201131996, -0.16130993407549055, -0.35804401228996, -0.14790554374169496, 0.08404134420035206, -0.10580080365684112, -0.3389324075683882, -0.13729419739536702, -0.3736839775883941]
 [-0.025099747815551857, -0.7564424692899987, -0.2428497419961927, -0.326587575040898, -0.13950010583620318, -0.5730127690565749, -0.11460916980709596, -0.751365629560958, -0.09099387130013452, -0.3278555944058385  …  -0.12330567550462053, -0.53257305293965, -0.10958788232016442, -0.4617681349541636, -0.13594728579303256, 0.0502438471721234, -0.12655765933271795, -0.39895287989686423, -0.14689765479709613, -0.3828072408306773]
 [-0.1367220125913459, -0.8678816975771414, -0.16487952070266781, -0.28858423884157347, -0.1320302653189266, -0.6162522892216632, -0.10067444326712457, -0.7762515838540542, -0.10419099662639672, -0.27714103390033823  …  -0.1686013647798458, -0.5037928056898573, -0.11676606063023565, -0.4858836788009751, -0.10311980918993284, -0.08921851448324906, -0.15073800063487405, -0.40993029380080725, -0.15471004649648515, -0.4181137210818443]
 [-0.18258323268743995, -0.7442542580607676, -0.09114290857626425, -0.3189318964236603, -0.19652553214297805, -0.6074088588069921, -0.2149791334132339, -0.6673978512068535, -0.11213311440562392, -0.41458448440822976  …  -0.13763608788413945, -0.5828321351686466, -0.11285938699577044, -0.4654892126592365, -0.09103146764510794, -0.11927790674220726, -0.12945029513529008, -0.3441232393195021, -0.23875416799892982, -0.35052622213794815]
 [-0.25565215080605597, -0.6801033171139458, -0.046024973608521376, -0.41373593201401415, -0.2546535632110574, -0.486667370501698, -0.28909725562607447, -0.5929156943800988, -0.1346208947897955, -0.4528901155781992  …  -0.18324913383653746, -0.4713906606103036, -0.1160957533226647, -0.46502155598340833, -0.1046319532986232, -0.1820125239075804, -0.14775490332030364, -0.40021189180028, -0.2658686138354177, -0.28493992769817716]
 [-0.3252853495745501, -0.604071794448185, -0.08198217439954619, -0.561239089173655, -0.23628741935796124, -0.3611722697871485, -0.24341718953558006, -0.527014922315028, -0.19033988670770174, -0.48257302910279115  …  -0.18960279177849151, -0.40496942230641225, -0.12361434933944498, -0.4500791407715201, -0.14471973628340432, -0.29154995532160966, -0.17210617676537876, -0.4860204214022908, -0.17737617853302154, -0.25171611783454145]
 [-0.28103940498738755, -0.3731817263773439, -0.08007650764370941, -0.6530787938192983, -0.1536730633227167, -0.2057637524468794, -0.09239495648514848, -0.5359037668740084, -0.27844151697802627, -0.37186457833078146  …  -0.20741276952214754, -0.31992453564566814, -0.1206818897668041, -0.49913152348432965, -0.11384697103777452, -0.33553202834897594, -0.1485018260056881, -0.3443316465213867, -0.19198040285593632, -0.23252108207136726]</code></pre><p>Let us plot the voltage potential of the first couple of components</p><pre><code class="language-julia hljs">v1 = voltage_timeseries(blocks[1], sol)
v2 = voltage_timeseries(blocks[2], sol)

fig = Figure()
ax = Axis(fig[1,1]; xlabel = &quot;time (ms)&quot;, ylabel = &quot;Potential&quot;)
lines!(ax, sol.t, v1)
lines!(ax, sol.t, v2)
xlims!(ax, (0, 1000)) ## limit the x-axis to the first second of simulation
fig</code></pre><img src="76055a51.png" alt="Example block output"/><p>To evaluate the connectivity of our simulated resting state network, we calculate the statistically significant correlations</p><pre><code class="language-julia hljs">cs = []
for i in 1:Int((length(sol.t)-1)/1000)-1
    solv = Array(sol[1:2:end,(i-1)*1000+1:(i*1000)])&#39;
    push!(cs,cor(solv))
end
css = stack(cs)

p = zeros(76,76)
for i in 1:76
    for j in 1:76
        p[i,j] = pvalue(OneSampleTTest(css[i,j,:]))
    end
end

heatmap(log10.(p) .* (p .&lt; 0.05))</code></pre><img src="77bd10f9.png" alt="Example block output"/><p>Fig.: log10(p value) displaying statistally significant correlation between time series</p><pre><code class="language-julia hljs">heatmap(wm)</code></pre><img src="97dcf012.png" alt="Example block output"/><p>Fig.: Connection Adjacency Matrix that was used to connect the neural mass models</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../getting_started/">« Getting Started</a><a class="docs-footer-nextpage" href="../parkinsons/">Building a model of Parkinson&#39;s disease using Neural Mass models »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Friday 4 October 2024 07:10">Friday 4 October 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
