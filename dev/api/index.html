<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · Neuroblox</title><meta name="title" content="API · Neuroblox"/><meta property="og:title" content="API · Neuroblox"/><meta property="twitter:title" content="API · Neuroblox"/><meta name="description" content="Documentation for Neuroblox."/><meta property="og:description" content="Documentation for Neuroblox."/><meta property="twitter:description" content="Documentation for Neuroblox."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="Neuroblox logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Neuroblox</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Neuroblox</a></li><li><a class="tocitem" href="../install/">How to install</a></li><li><a class="tocitem" href="../getting_started/">Getting Started</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../tutorials/resting_state/">Resting state simulation using neural mass models</a></li><li><a class="tocitem" href="../tutorials/ping_network/">Pyramidal-Interneuron Gamma network</a></li><li><a class="tocitem" href="../tutorials/parkinsons/">Building a model of the Basal Ganglia using Neural Mass models</a></li><li><a class="tocitem" href="../tutorials/basal_ganglia/">Basal Ganglia Model and Parkinson&#39;s Disease Simulation</a></li><li><a class="tocitem" href="../tutorials/neural_assembly/">Bottom-up construction of a neural assembly</a></li><li><a class="tocitem" href="../tutorials/spectralDCM/">Solving Inverse Problems with Spectral Dynamic Causal Modeling</a></li></ul></li><li class="is-active"><a class="tocitem" href>API</a></li><li><a class="tocitem" href="../release_notes/">Release Notes</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Neuroblox/Neuroblox.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Neuroblox/Neuroblox.jl/blob/master/docs/src/api.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API-Documentation"><a class="docs-heading-anchor" href="#API-Documentation">API Documentation</a><a id="API-Documentation-1"></a><a class="docs-heading-anchor-permalink" href="#API-Documentation" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Neuroblox.BalloonModel" href="#Neuroblox.BalloonModel"><code>Neuroblox.BalloonModel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Arguments:</p><ul><li><code>name</code>: Name given to <code>ODESystem</code> object within the blox.</li><li><code>namespace</code>: Additional namespace above <code>name</code> if needed for inheritance.</li><li><code>lnκ</code>: logarithmic prefactor to signal decay H[1], set to 0 for standard parameter value.</li><li><code>lnτ</code>: logarithmic prefactor to transit time H[3], set to 0 for standard parameter value.</li><li><code>lnϵ</code>: logarithm of ratio of intra- to extra-vascular signal</li></ul><p>NB: the prefix ln of the variables u, ν, q as well as the parameters κ, τ denotes their transformation into logarithmic space to enforce their positivity. This transformation is considered in the derivates of the model equations below. </p><p>Citations:</p><ol><li>Stephan K E, Weiskopf N, Drysdale P M, Robinson P A, and Friston K J. Comparing Hemodynamic Models with DCM. NeuroImage 38, no. 3 (2007): 387–401. doi: 10.1016/j.neuroimage.2007.07.040</li><li>Hofmann D, Chesebro A G, Rackauckas C, Mujica-Parodi L R, Friston K J, Edelman A, and Strey H H. Leveraging Julia&#39;s Automated Differentiation and Symbolic Computation to Increase Spectral DCM Flexibility and Speed, 2023. doi: 10.1101/2023.10.27.564407</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Neuroblox/Neuroblox.jl/blob/c259f9fff45c2b5a7d498165a29697cccabb0ab7/src/measurementmodels/fmri.jl#L30-L45">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Neuroblox.DBS-Tuple{}" href="#Neuroblox.DBS-Tuple{}"><code>Neuroblox.DBS</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DBS(; name, namespace=nothing, frequency=130.0, amplitude=2.5, pulse_width=0.066, 
    offset=0.0, start_time=0.0, smooth=1e-4)</code></pre><p>Create a continuous deep brain stimulation (DBS) stimulus with regular pulses.</p><p>Arguments:</p><ul><li>name: Name given to ODESystem object within the blox</li><li>namespace: Additional namespace above name if needed for inheritance</li><li>frequency: Pulse frequency in Hz </li><li>amplitude: Pulse amplitude in arbitrary units</li><li>pulse_width: Duration of each pulse in ms</li><li>offset: Baseline value of the signal between pulses</li><li>start_time: Time delay before stimulation begins in ms</li><li>smooth: Smoothing parameter for pulse transitions, set to 0 for sharp transitions</li></ul><p>Returns a DBS stimulus blox that outputs square pulses with specified parameters.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Neuroblox/Neuroblox.jl/blob/c259f9fff45c2b5a7d498165a29697cccabb0ab7/src/blox/DBS_sources.jl#L9-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Neuroblox.Generic2dOscillator" href="#Neuroblox.Generic2dOscillator"><code>Neuroblox.Generic2dOscillator</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Generic2dOscillator(name, namespace, ...)

The Generic2dOscillator model is a generic dynamic system with two state
variables. The dynamic equations of this model are composed of two ordinary
differential equations comprising two nullclines. The first nullcline is a
cubic function as it is found in most neuron and population models; the
second nullcline is arbitrarily configurable as a polynomial function up to
second order. The manipulation of the latter nullcline&#39;s parameters allows
to generate a wide range of different behaviours.

Equations:

```math
        \begin{align}
        \dot{V} &amp;= d \, \tau (-f V^3 + e V^2 + g V + \alpha W + \gamma I) \\
        \dot{W} &amp;= \dfrac{d}{	au}\,\,(c V^2 + b V - \beta W + a)
        \end{align}
```</code></pre><p>Arguments:</p><ul><li>name: Name given to ODESystem object within the blox.</li><li>namespace: Additional namespace above name if needed for inheritance.</li><li>Other parameters: See reference for full list. Note that parameters are scaled so that units of time are in milliseconds.</li></ul><p>Citations: FitzHugh, R., Impulses and physiological states in theoretical models of nerve membrane, Biophysical Journal 1: 445, 1961.</p><p>Nagumo et.al, An Active Pulse Transmission Line Simulating Nerve Axon, Proceedings of the IRE 50: 2061, 1962.</p><p>Stefanescu, R., Jirsa, V.K. Reduced representations of heterogeneous mixed neural networks with synaptic coupling. Physical Review E, 83, 2011.</p><p>Jirsa VK, Stefanescu R.  Neural population modes capture biologically realistic large-scale network dynamics. Bulletin of Mathematical Biology, 2010.</p><p>Stefanescu, R., Jirsa, V.K. A low dimensional description of globally coupled heterogeneous neural networks of excitatory and inhibitory neurons. PLoS Computational Biology, 4(11), 2008).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Neuroblox/Neuroblox.jl/blob/c259f9fff45c2b5a7d498165a29697cccabb0ab7/src/blox/neural_mass.jl#L348-L392">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Neuroblox.HarmonicOscillator" href="#Neuroblox.HarmonicOscillator"><code>Neuroblox.HarmonicOscillator</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">HarmonicOscillator(name, namespace, ω, ζ, k, h)

Create a harmonic oscillator blox with the specified parameters.
The formal definition of this blox is:</code></pre><p class="math-container">\[\frac{dx}{dt} = y-(2*\omega*\zeta*x)+ k*(2/\pi)*(atan((\sum{jcn})/h)
\frac{dy}{dt} = -(\omega^2)*x\]</p><pre><code class="nohighlight hljs">where ``jcn`` is any input to the blox.</code></pre><p>Arguments:</p><ul><li>name: Name given to ODESystem object within the blox.</li><li>namespace: Additional namespace above name if needed for inheritance.</li><li>ω: Base frequency. Note the default value is scaled to give oscillations in milliseconds to match other blocks.</li><li>ζ: Damping ratio.</li><li>k: Gain.</li><li>h: Threshold.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Neuroblox/Neuroblox.jl/blob/c259f9fff45c2b5a7d498165a29697cccabb0ab7/src/blox/neural_mass.jl#L110-L130">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Neuroblox.JansenRit" href="#Neuroblox.JansenRit"><code>Neuroblox.JansenRit</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">JansenRit(name, namespace, τ, H, λ, r, cortical, delayed)

Create a Jansen Rit blox as described in Liu et al.
The formal definition of this blox is:</code></pre><p class="math-container">\[\frac{dx}{dt} = y-\frac{2}{\tau}x
\frac{dy}{dt} = -\frac{x}{\tau^2} + \frac{H}{\tau} [\frac{2\lambda}{1+\text{exp}(-r*\sum{jcn})} - \lambda]\]</p><p>where <span>$jcn$</span> is any input to the blox.</p><p>Arguments:</p><ul><li>name: Name given to ODESystem object within the blox.</li><li>namespace: Additional namespace above name if needed for inheritance.</li><li>τ: Time constant. Defaults to 1 for cortical regions, 14 for subcortical.</li><li>H: See equation for use. Defaults to 0.02 for both cortical and subcortical regions.</li><li>λ: See equation for use. Defaults to 5 for cortical regions, 400 for subcortical.</li><li>r: See equation for use. Defaults to 0.15 for cortical regions, 0.1 for subcortical.</li><li>cortical: Boolean to determine whether to use cortical or subcortical parameters. Specifying any of the parameters above will override this.</li><li>delayed: Boolean to indicate whether states are delayed</li></ul><p>Citations:</p><ol><li>Liu C, Zhou C, Wang J, Fietkiewicz C, Loparo KA. The role of coupling connections in a model of the cortico-basal ganglia-thalamocortical neural loop for the generation of beta oscillations. Neural Netw. 2020 Mar;123:381-392. doi: 10.1016/j.neunet.2019.12.021.</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Neuroblox/Neuroblox.jl/blob/c259f9fff45c2b5a7d498165a29697cccabb0ab7/src/blox/neural_mass.jl#L150-L176">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Neuroblox.JansenRitSPM12" href="#Neuroblox.JansenRitSPM12"><code>Neuroblox.JansenRitSPM12</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Jansen-Rit model block for canonical micro circuit, analogous to the implementation in SPM12</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Neuroblox/Neuroblox.jl/blob/c259f9fff45c2b5a7d498165a29697cccabb0ab7/src/blox/canonicalmicrocircuit.jl#L3-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Neuroblox.KuramotoOscillator" href="#Neuroblox.KuramotoOscillator"><code>Neuroblox.KuramotoOscillator</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">KuramotoOscillator(name, namespace, ...)

Simple implementation of the Kuramoto oscillator as described in the original paper [1].
Useful for general models of synchronization and oscillatory behavior.
The general form of the Kuramoto oscillator is given by:
Equations:

```math
        \begin{equation}
        \dot{\theta_i} = \omega_i + \frac{1}{N}\sum_{j=1}^N{K_{i, j}\text{sin}(\theta_j - \theta_i)}
        \end{equation}
```

Where this describes the connection between regions $i$ and $j$. An alternative form
which includes a noise term for each region is also provided, taking the form:

```math
        \begin{equation}
        \dot{\theta_i} = \omega_i + \zeta dW_i \frac{1}{N}\sum_{j=1}^N{K_{i, j}\text{sin}(\theta_j - \theta_i)}
        \end{equation}
```

where $W_i$ is a Wiener process and $\zeta_i$ is the noise strength.</code></pre><p>Arguments:</p><ul><li>name: Name given to ODESystem object within the blox.</li><li>namespace: Additional namespace above name if needed for inheritance.</li><li>Other parameters: See reference for full list. Note that parameters are scaled so that units of time are in milliseconds.                   Default parameter values are taken from [2].</li></ul><p>Citations:</p><ol><li><p>Kuramoto, Y. (1975). Self-entrainment of a population of coupled non-linear oscillators.  In: Araki, H. (eds) International Symposium on Mathematical Problems in Theoretical Physics.  Lecture Notes in Physics, vol 39. Springer, Berlin, Heidelberg. https://doi.org/10.1007/BFb0013365</p></li><li><p>Sermon JJ, Wiest C, Tan H, Denison T, Duchet B. Evoked resonant neural activity long-term  dynamics can be reproduced by a computational model with vesicle depletion. Neurobiol Dis.  2024 Jun 14;199:106565. doi: 10.1016/j.nbd.2024.106565. Epub ahead of print. PMID: 38880431.</p></li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Neuroblox/Neuroblox.jl/blob/c259f9fff45c2b5a7d498165a29697cccabb0ab7/src/blox/neural_mass.jl#L426-L466">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Neuroblox.LarterBreakspear" href="#Neuroblox.LarterBreakspear"><code>Neuroblox.LarterBreakspear</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LarterBreakspear(name, namespace, ...)

Create a Larter Breakspear blox described in Endo et al. For a full list of the parameters used see the reference.
If you need to modify the parameters, see Chesebro et al. and van Nieuwenhuizen et al. for physiological ranges.</code></pre><p>Arguments:</p><ul><li>name: Name given to ODESystem object within the blox.</li><li>namespace: Additional namespace above name if needed for inheritance.</li><li>Other parameters: See reference for full list. Note that parameters are scaled so that units of time are in milliseconds.</li></ul><p>Citations:</p><ol><li>Endo H, Hiroe N, Yamashita O. Evaluation of Resting Spatio-Temporal Dynamics of a Neural Mass Model Using Resting fMRI Connectivity and EEG Microstates. Front Comput Neurosci. 2020 Jan 17;13:91. doi: 10.3389/fncom.2019.00091.</li><li>Chesebro AG, Mujica-Parodi LR, Weistuch C. Ion gradient-driven bifurcations of a multi-scale neuronal model. Chaos Solitons Fractals. 2023 Feb;167:113120. doi: 10.1016/j.chaos.2023.113120. </li><li>van Nieuwenhuizen, H, Chesebro, AG, Polis, C, Clarke, K, Strey, HH, Weistuch, C, Mujica-Parodi, LR. Ketosis regulates K+ ion channels, strengthening brain-wide signaling disrupted by age. Preprint. bioRxiv 2023.05.10.540257; doi: https://doi.org/10.1101/2023.05.10.540257. </li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Neuroblox/Neuroblox.jl/blob/c259f9fff45c2b5a7d498165a29697cccabb0ab7/src/blox/neural_mass.jl#L270-L286">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Neuroblox.OUBlox" href="#Neuroblox.OUBlox"><code>Neuroblox.OUBlox</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Ornstein-Uhlenbeck process Blox</p><p>variables:     x(t):  value     jcn:   input  parameters:     τ:      relaxation time 	μ:      average value 	σ:      random noise (variance of OU process is τ*σ^2/2) returns:     an ODE System (but with brownian parameters)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Neuroblox/Neuroblox.jl/blob/c259f9fff45c2b5a7d498165a29697cccabb0ab7/src/blox/stochastic.jl#L1-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Neuroblox.PINGNeuronExci" href="#Neuroblox.PINGNeuronExci"><code>Neuroblox.PINGNeuronExci</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PINGNeuronExci(name, namespace, C, g_Na, V_Na, g_K, V_K, g_L, V_L, I_ext, τ_R, τ_D)

Create an excitatory neuron from Borgers et al. (2008).
The formal definition of this blox is:</code></pre><p class="math-container">\[\frac{dV}{dt} = \frac{1}{C}(-g_{Na}*m_{\infty}^3*h*(V - V_{Na}) - g_K*n^4*(V - V_K) - g_L*(V - V_L) + I_{ext} + jcn)
\m_{\infty} = \frac{a_m(V)}{a_m(V) + b_m(V)}
\frac{dn}{dt} = a_n(V)*(1 - n) - b_n(V)*n
\frac{dh}{dt} = a_h(V)*(1 - h) - b_h(V)*h
\frac{ds}{dt} = \frac{1}{2}*(1 + \tanh(V/10))*(\frac{1 - s}{\tau_R} - \frac{s}{\tau_D})\]</p><p>where <span>$jcn$</span> is any input to the blox. Note that this is a modified Hodgkin-Huxley formalism with an additional synaptic accumulation term. Synapses are added into the <span>$jcn$</span> term by connecting the postsynaptic neuron&#39;s voltage to the presynaptic neuron&#39;s output:</p><p class="math-container">\[jcn = w*s*(V_E - V)\]</p><p>where <span>$w$</span> is the weight of the synapse and <span>$V_E$</span> is the reversal potential of the excitatory synapse.</p><p>Inputs:</p><ul><li>name: Name given to ODESystem object within the blox.</li><li>namespace: Additional namespace above name if needed for inheritance.</li><li>C: Membrane capacitance (defaults to 1.0).</li><li>g_Na: Sodium conductance (defaults to 100.0).</li><li>V_Na: Sodium reversal potential (defaults to 50.0).</li><li>g_K: Potassium conductance (defaults to 80.0).</li><li>V_K: Potassium reversal potential (defaults to -100.0).</li><li>g_L: Leak conductance (defaults to 0.1).</li><li>V_L: Leak reversal potential (defaults to -67.0).</li><li>I_ext: External current (defaults to 0.0).</li><li>τ_R: Rise time of synaptic conductance (defaults to 0.2).</li><li>τ_D: Decay time of synaptic conductance (defaults to 2.0).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Neuroblox/Neuroblox.jl/blob/c259f9fff45c2b5a7d498165a29697cccabb0ab7/src/blox/ping_neuron_examples.jl#L4-L37">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Neuroblox.PINGNeuronInhib" href="#Neuroblox.PINGNeuronInhib"><code>Neuroblox.PINGNeuronInhib</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PINGNeuronInhib(name, namespace, C, g_Na, V_Na, g_K, V_K, g_L, V_L, I_ext, τ_R, τ_D)

Create an inhibitory neuron from Borgers et al. (2008).
The formal definition of this blox is:</code></pre><p class="math-container">\[\frac{dV}{dt} = \frac{1}{C}(-g_{Na}*m_{\infty}^3*h*(V - V_{Na}) - g_K*n^4*(V - V_K) - g_L*(V - V_L) + I_{ext} + jcn)
\m_{\infty} = \frac{a_m(V)}{a_m(V) + b_m(V)}
\frac{dn}{dt} = a_n(V)*(1 - n) - b_n(V)*n
\frac{dh}{dt} = a_h(V)*(1 - h) - b_h(V)*h
\frac{ds}{dt} = \frac{1}{2}*(1 + \tanh(V/10))*(\frac{1 - s}{\tau_R} - \frac{s}{\tau_D})\]</p><p>where <span>$jcn$</span> is any input to the blox. Note that this is a modified Hodgkin-Huxley formalism with an additional synaptic accumulation term. Synapses are added into the <span>$jcn$</span> term by connecting the postsynaptic neuron&#39;s voltage to the presynaptic neuron&#39;s output:</p><p class="math-container">\[jcn = w*s*(V_I - V)\]</p><p>where <span>$w$</span> is the weight of the synapse and <span>$V_I$</span> is the reversal potential of the inhibitory synapse.</p><p>Inputs:</p><ul><li>name: Name given to ODESystem object within the blox.</li><li>namespace: Additional namespace above name if needed for inheritance.</li><li>C: Membrane capacitance (defaults to 1.0).</li><li>g_Na: Sodium conductance (defaults to 35.0).</li><li>V_Na: Sodium reversal potential (defaults to 55.0).</li><li>g_K: Potassium conductance (defaults to 9.0).</li><li>V_K: Potassium reversal potential (defaults to -90.0).</li><li>g_L: Leak conductance (defaults to 0.1).</li><li>V_L: Leak reversal potential (defaults to -65.0).</li><li>I_ext: External current (defaults to 0.0).</li><li>τ_R: Rise time of synaptic conductance (defaults to 0.5).</li><li>τ_D: Decay time of synaptic conductance (defaults to 10.0).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Neuroblox/Neuroblox.jl/blob/c259f9fff45c2b5a7d498165a29697cccabb0ab7/src/blox/ping_neuron_examples.jl#L78-L111">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Neuroblox.Striatum" href="#Neuroblox.Striatum"><code>Neuroblox.Striatum</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Subcortical blox
all subcprtical blox used in cortico-striatal model are defined here</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Neuroblox/Neuroblox.jl/blob/c259f9fff45c2b5a7d498165a29697cccabb0ab7/src/blox/subcortical_blox.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Neuroblox.WilsonCowan" href="#Neuroblox.WilsonCowan"><code>Neuroblox.WilsonCowan</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">WilsonCowan(name, namespace, τ_E, τ_I, a_E, a_I, c_EE, c_IE, c_EI, c_II, θ_E, θ_I, η)

Create a standard Wilson Cowan blox.
The formal definition of this blox is:</code></pre><p class="math-container">\[\frac{dE}{dt} = \frac{-E}{\tau_E} + \frac{1}{1 + \text{exp}(-a_E*(c_{EE}*E - c_{IE}*I - \theta_E + \eta*(\sum{jcn}))}
\frac{dI}{dt} = \frac{-I}{\tau_I} + \frac{1}{1 + exp(-a_I*(c_{EI}*E - c_{II}*I - \theta_I)}\]</p><p>where <span>$jcn$</span> is any input to the blox.</p><p>Arguments:</p><ul><li>name: Name given to ODESystem object within the blox.</li><li>namespace: Additional namespace above name if needed for inheritance.</li><li>Others: See equation for use.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Neuroblox/Neuroblox.jl/blob/c259f9fff45c2b5a7d498165a29697cccabb0ab7/src/blox/neural_mass.jl#L222-L238">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Neuroblox.WinnerTakeAllBlox" href="#Neuroblox.WinnerTakeAllBlox"><code>Neuroblox.WinnerTakeAllBlox</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">WinnerTakeAllBlox</code></pre><p>Creates a winner-take-all local circuit found in neocortex, typically 5 pyramidal (excitatory) neurons send synapses to a single interneuron (inhibitory) and receive feedback inhibition from that interneuron.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Neuroblox/Neuroblox.jl/blob/c259f9fff45c2b5a7d498165a29697cccabb0ab7/src/blox/winnertakeall.jl#L1-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LinearAlgebra.eigen-Union{Tuple{Array{ForwardDiff.Dual{T, P, np}, 2}}, Tuple{np}, Tuple{P}, Tuple{T}} where {T, P, np}" href="#LinearAlgebra.eigen-Union{Tuple{Array{ForwardDiff.Dual{T, P, np}, 2}}, Tuple{np}, Tuple{P}, Tuple{T}} where {T, P, np}"><code>LinearAlgebra.eigen</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function LinearAlgebra.eigen(M::Matrix{Dual{T, P, np}}) where {T, P, np}

Dispatch of LinearAlgebra.eigen for dual matrices with complex numbers. Make the eigenvalue decomposition 
amenable to automatic differentiation. To do so compute the analytical derivative of eigenvalues
and eigenvectors. 

Arguments:
- `M`: matrix of type Dual of which to compute the eigenvalue decomposition. 

Returns:
- `Eigen(evals, evecs)`: eigenvalue decomposition returned as type LinearAlgebra.Eigen</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Neuroblox/Neuroblox.jl/blob/c259f9fff45c2b5a7d498165a29697cccabb0ab7/src/datafitting/spDCM_VL.jl#L43-L55">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Neuroblox.ARVTarget-NTuple{6, Any}" href="#Neuroblox.ARVTarget-NTuple{6, Any}"><code>Neuroblox.ARVTarget</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>ARVTarget Time series data is bandpass filtered and then the power spectrum is computed for a given time interval (control bin), returned as the average value of the power spectral density within a certain frequency band ([lb, ub]).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Neuroblox/Neuroblox.jl/blob/c259f9fff45c2b5a7d498165a29697cccabb0ab7/src/control/controlerror.jl#L1-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Neuroblox.CDVTarget-NTuple{5, Any}" href="#Neuroblox.CDVTarget-NTuple{5, Any}"><code>Neuroblox.CDVTarget</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>CDVTarget Time series data is bandpass filtered and hilbert-transformed. Phase angle is computed in radians. Circular difference is quantified as the angle of circular_location.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Neuroblox/Neuroblox.jl/blob/c259f9fff45c2b5a7d498165a29697cccabb0ab7/src/control/controlerror.jl#L20-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Neuroblox.ControlError-NTuple{8, Any}" href="#Neuroblox.ControlError-NTuple{8, Any}"><code>Neuroblox.ControlError</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>ControlError Returns the control error (deviation of the actual value from the target value).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Neuroblox/Neuroblox.jl/blob/c259f9fff45c2b5a7d498165a29697cccabb0ab7/src/control/controlerror.jl#L89-L92">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Neuroblox.PDVTarget-NTuple{5, Any}" href="#Neuroblox.PDVTarget-NTuple{5, Any}"><code>Neuroblox.PDVTarget</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>PDVTarget Time series data is bandpass filtered and hilbert-transformed. Phase angle is computed in radians. Phase deviation is quantified as the angle difference between a given set of signals.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Neuroblox/Neuroblox.jl/blob/c259f9fff45c2b5a7d498165a29697cccabb0ab7/src/control/controlerror.jl#L36-L41">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Neuroblox.PLVTarget-NTuple{6, Any}" href="#Neuroblox.PLVTarget-NTuple{6, Any}"><code>Neuroblox.PLVTarget</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>PLVTarget Time series data is bandpass filtered and hilbert-transformed. Phase angle is computed in radians.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Neuroblox/Neuroblox.jl/blob/c259f9fff45c2b5a7d498165a29697cccabb0ab7/src/control/controlerror.jl#L51-L56">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Neuroblox.ProtocolDBS-Tuple{}" href="#Neuroblox.ProtocolDBS-Tuple{}"><code>Neuroblox.ProtocolDBS</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ProtocolDBS(; name, namespace=nothing, frequency=130.0, amplitude=2.5,
              pulse_width=0.066, offset=0.0, start_time=0.0, smooth=1e-4,
              pulses_per_burst=10, bursts_per_block=12, 
              pre_block_time=200.0, inter_burst_time=200.0)</code></pre><p>Create a deep brain stimulation (DBS) stimulus consisting of a block of pulse bursts.</p><p>Arguments:</p><ul><li>name: Name given to ODESystem object within the blox</li><li>namespace: Additional namespace above name if needed for inheritance</li><li>frequency: Pulse frequency in Hz</li><li>amplitude: Pulse amplitude in arbitrary units  </li><li>pulse_width: Duration of each pulse in ms</li><li>offset: Baseline value of the signal between pulses</li><li>start_time: Time delay before stimulation begins in ms</li><li>smooth: Smoothing parameter for pulse transitions, set to 0 for sharp transitions</li><li>pulses<em>per</em>burst: Number of pulses in each burst</li><li>bursts<em>per</em>block: Number of bursts in the block</li><li>pre<em>block</em>time: Time before the block starts in ms</li><li>inter<em>burst</em>time: Time between bursts in ms</li></ul><p>Returns a DBS stimulus blox that outputs a block of pulse bursts.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Neuroblox/Neuroblox.jl/blob/c259f9fff45c2b5a7d498165a29697cccabb0ab7/src/blox/DBS_sources.jl#L67-L90">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Neuroblox.addnontunableparams-Tuple{Any, Any}" href="#Neuroblox.addnontunableparams-Tuple{Any, Any}"><code>Neuroblox.addnontunableparams</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function addnontunableparams(param, model)

Function adds parameters of a model that were not marked as tunable to a list of tunable parameters
and respects the MTK ordering of parameters.

Arguments:
- `paramlist`: parameters of an MTK system that were tagged as tunable
- `sys`: MTK system

Returns:
- `completeparamlist`: complete parameter list of a system, including those that were not tagged as tunable</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Neuroblox/Neuroblox.jl/blob/c259f9fff45c2b5a7d498165a29697cccabb0ab7/src/blox/blox_utilities.jl#L378-L390">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Neuroblox.bandpassfilter-Tuple{}" href="#Neuroblox.bandpassfilter-Tuple{}"><code>Neuroblox.bandpassfilter</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>bandpassfilter takes in time series data and bandpass filters it. It has the following inputs:     data: time series data     lb: minimum cut-off frequency     ub: maximum cut-off frequency     fs: sampling frequency     order: filter order</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Neuroblox/Neuroblox.jl/blob/c259f9fff45c2b5a7d498165a29697cccabb0ab7/src/utilities/spectral_tools.jl#L22-L30">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Neuroblox.boldsignal-Tuple{}" href="#Neuroblox.boldsignal-Tuple{}"><code>Neuroblox.boldsignal</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Arguments:</p><ul><li><code>name</code>: Name given to <code>ODESystem</code> object within the blox.</li><li>lnϵ  : logarithm of ratio of intra- to extra-vascular signal</li></ul><p>NB: the prefix ln of the variables ν, q as well as the parameters ϵ denotes their transformation into logarithmic space to enforce their positivity.</p><p>Citations:</p><ol><li>Stephan K E, Weiskopf N, Drysdale P M, Robinson P A, and Friston K J. Comparing Hemodynamic Models with DCM. NeuroImage 38, no. 3 (2007): 387–401. doi: 10.1016/j.neuroimage.2007.07.040</li><li>Hofmann D, Chesebro A G, Rackauckas C, Mujica-Parodi L R, Friston K J, Edelman A, and Strey H H. Leveraging Julia&#39;s Automated Differentiation and Symbolic Computation to Increase Spectral DCM Flexibility and Speed, 2023. doi: 10.1101/2023.10.27.564407</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Neuroblox/Neuroblox.jl/blob/c259f9fff45c2b5a7d498165a29697cccabb0ab7/src/measurementmodels/fmri.jl#L101-L114">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Neuroblox.complexwavelet" href="#Neuroblox.complexwavelet"><code>Neuroblox.complexwavelet</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>complexwavelet creates a complex morlet wavelet by windowing a complex sine wave with a Gaussian taper.  The morlet wavelet is a special case of a bandpass filter in which the frequency response is Gaussian-shaped. Convolution with a complex wavelet is equivalent to performing a Hilbert transform of a bandpass filtered signal.</p><p>It has the following inputs:     data: time series data      dt  : data sampling rate      lb  : lower bound wavelet frequency (in Hz)     ub  : upper bound wavelet frequency (in Hz)     a   : amplitude of the Gaussian taper, default is 1     n   : number of wavelet cycles of the Gaussian taper, defines the trade-off between temporal precision and frequency precision           larger n gives better frequency precision at the cost of temporal precision           default is 6 Hz     m   : x-axis offset, default is 0     num_wavelets : number of wavelets to create, default is 5</p><p>And outputs:     complex_wavelet : a family of complex morlet wavelets</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Neuroblox/Neuroblox.jl/blob/c259f9fff45c2b5a7d498165a29697cccabb0ab7/src/utilities/spectral_tools.jl#L72-L91">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Neuroblox.csd2mar-NTuple{4, Any}" href="#Neuroblox.csd2mar-NTuple{4, Any}"><code>Neuroblox.csd2mar</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>This function converts a cross-spectral density (CSD) into a multivariate auto-regression (MAR) model. It first transforms the CSD into its cross-correlation function (Wiener-Kinchine theorem) and then computes the MAR model coefficients. csd       : cross-spectral density matrix of size MxN; M: number of samples, N: number of cross-spectral dimensions (number of variables squared) w         : frequencies dt        : time step size p         : number of time steps of auto-regressive model</p><p>This function returns coeff     : array of length p of coefficient matrices of size sqrt(N)xsqrt(N) noise_cov : noise covariance matrix</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Neuroblox/Neuroblox.jl/blob/c259f9fff45c2b5a7d498165a29697cccabb0ab7/src/utilities/spectral_tools.jl#L185-L196">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Neuroblox.csd_approx-NTuple{4, Any}" href="#Neuroblox.csd_approx-NTuple{4, Any}"><code>Neuroblox.csd_approx</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">This function implements equation 2 of the spectral DCM paper, Friston et al. 2014 &quot;A DCM for resting state fMRI&quot;.
Note that nomenclature is taken from SPM12 code and it does not seem to coincide with the spectral DCM paper&#39;s nomenclature. 
For instance, Gu should represent the spectral component due to external input according to the paper. However, in the code this represents
the hidden state fluctuations (which are called Gν in the paper).
Gn in the code corresponds to Ge in the paper, i.e. the observation noise. In the code global and local components are defined, no such distinction
is discussed in the paper. In fact the parameter γ, corresponding to local component is not present in the paper.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Neuroblox/Neuroblox.jl/blob/c259f9fff45c2b5a7d498165a29697cccabb0ab7/src/datafitting/spDCM_VL.jl#L140-L147">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Neuroblox.get_dynamic_states-Tuple{Any}" href="#Neuroblox.get_dynamic_states-Tuple{Any}"><code>Neuroblox.get_dynamic_states</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function get_dynamic_states(sys)

Function extracts states from the system that are dynamic variables, 
get also indices of external inputs (u(t)) and measurements (like bold(t))
Arguments:
- `sys`: MTK system

Returns:
- `sts`: states/unknowns of the system that are neither external inputs nor measurements, i.e. these are the dynamic states
- `idx`: indices of these states</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Neuroblox/Neuroblox.jl/blob/c259f9fff45c2b5a7d498165a29697cccabb0ab7/src/blox/blox_utilities.jl#L325-L336">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Neuroblox.get_input_equations-Tuple{Union{Neuroblox.AbstractBlox, Neuroblox.ObserverBlox}}" href="#Neuroblox.get_input_equations-Tuple{Union{Neuroblox.AbstractBlox, Neuroblox.ObserverBlox}}"><code>Neuroblox.get_input_equations</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Returns the equations for all input variables of a system, 
assuming they have a form like : `sys.input_variable ~ ...`
so only the input appears on the LHS.

Input equations are namespaced by the inner namespace of blox
and then they are returned. This way during system `compose` downstream,
the higher-level namespaces will be added to them.

If blox isa AbstractComponent, it is assumed that it contains a `connector` field,
which holds a `Connector` object with all relevant connections 
from lower levels and this level.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Neuroblox/Neuroblox.jl/blob/c259f9fff45c2b5a7d498165a29697cccabb0ab7/src/blox/blox_utilities.jl#L185-L197">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Neuroblox.idft-Tuple{AbstractArray}" href="#Neuroblox.idft-Tuple{AbstractArray}"><code>Neuroblox.idft</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Plain implementation of idft because AD dispatch versions for ifft don&#39;t work still!</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Neuroblox/Neuroblox.jl/blob/c259f9fff45c2b5a7d498165a29697cccabb0ab7/src/utilities/spectral_tools.jl#L172-L174">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Neuroblox.inner_namespaceof-Tuple{Any}" href="#Neuroblox.inner_namespaceof-Tuple{Any}"><code>Neuroblox.inner_namespaceof</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Returns the complete namespace EXCLUDING the outermost (highest) level.
This is useful for manually preparing equations (e.g. connections, see Connector),
that will later be composed and will automatically get the outermost namespace.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Neuroblox/Neuroblox.jl/blob/c259f9fff45c2b5a7d498165a29697cccabb0ab7/src/blox/blox_utilities.jl#L139-L143">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Neuroblox.learningrate-Tuple{Any, Any}" href="#Neuroblox.learningrate-Tuple{Any, Any}"><code>Neuroblox.learningrate</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>This function computes learning rate. It has the following inputs:     outcomes: vector of 1&#39;s and 0&#39;s for behavioral outcomes     windows: number of windows to split the outcome data into And the following outputs:     rate: the learning rate across each window</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Neuroblox/Neuroblox.jl/blob/c259f9fff45c2b5a7d498165a29697cccabb0ab7/src/utilities/learning_tools.jl#L1-L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Neuroblox.mar2csd-Tuple{Any, Any, Any}" href="#Neuroblox.mar2csd-Tuple{Any, Any, Any}"><code>Neuroblox.mar2csd</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>This function converts multivariate auto-regression (MAR) model parameters to a cross-spectral density (CSD). A     : coefficients of MAR model, array of length p, each element contains the regression coefficients for that particular time-lag. Σ     : noise covariance matrix of MAR p     : number of time lags freqs : frequencies at which to evaluate the CSD sf    : sampling frequency</p><p>This function returns: csd   : cross-spectral density matrix of size MxN; M: number of samples, N: number of cross-spectral dimensions (number of variables squared)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Neuroblox/Neuroblox.jl/blob/c259f9fff45c2b5a7d498165a29697cccabb0ab7/src/utilities/spectral_tools.jl#L119-L129">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Neuroblox.mar_ml-Tuple{Any, Any}" href="#Neuroblox.mar_ml-Tuple{Any, Any}"><code>Neuroblox.mar_ml</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Maximum likelihood estimator of a multivariate, or vector auto-regressive model.     y : MxN Data matrix where M is number of samples and N is number of dimensions     p : time lag parameter, also called order of MAR model     return values     mar[&quot;A&quot;] : model parameters is a NxNxP tensor, i.e. one NxN parameter matrix for each time bin k ∈ {1,...,p}     mar[&quot;Σ&quot;] : noise covariance matrix</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Neuroblox/Neuroblox.jl/blob/c259f9fff45c2b5a7d498165a29697cccabb0ab7/src/utilities/spectral_tools.jl#L245-L252">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Neuroblox.params-Tuple{Connector}" href="#Neuroblox.params-Tuple{Connector}"><code>Neuroblox.params</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Helper to merge delay and weight into a single vector</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Neuroblox/Neuroblox.jl/blob/c259f9fff45c2b5a7d498165a29697cccabb0ab7/src/blox/connections.jl#L203-L205">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Neuroblox.paramscoping-Tuple{}" href="#Neuroblox.paramscoping-Tuple{}"><code>Neuroblox.paramscoping</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function paramscoping(;tunable=true, kwargs...)

Scope arguments that are already a symbolic model parameter thereby keep the correct namespace 
and make those that are not yet symbolic a symbol.
Keyword arguments are used, because parameter definition require names, not just values.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Neuroblox/Neuroblox.jl/blob/c259f9fff45c2b5a7d498165a29697cccabb0ab7/src/blox/blox_utilities.jl#L11-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Neuroblox.phase_cos_blox-Union{Tuple{F}, Tuple{Any, Any, F}} where F" href="#Neuroblox.phase_cos_blox-Union{Tuple{F}, Tuple{Any, Any, F}} where F"><code>Neuroblox.phase_cos_blox</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>phase<em>cos</em>blox is creating a cos with angular frequency ω and variable phase phase<em>inter has the following parameters:     ω: angular frequency     t: time     phase</em>inter: a function that returns phase as a function of time and returns:     the resulting value</p><p>Usage:     phase<em>int = phase</em>inter(0:0.1:50,phase<em>data)     phase</em>out(t) = phase<em>cos</em>blox(0.1,t,phase<em>int)     which is now a function of time and can be used in an input blox     you can also use the dot operator to calculate time-series     signal = phase</em>out.(collect(0:0.01:50))</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Neuroblox/Neuroblox.jl/blob/c259f9fff45c2b5a7d498165a29697cccabb0ab7/src/blox/ts_outputs.jl#L18-L33">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Neuroblox.phase_inter-Tuple{Any, Any}" href="#Neuroblox.phase_inter-Tuple{Any, Any}"><code>Neuroblox.phase_inter</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>phase<em>inter is creating a function that interpolates the phase data for any time given phase</em>inter has the following parameters:     phase<em>range:  a range, e.g. 0:0.1:50 which should reflect the time points of the data     phase</em>data: phase at equidistant time points and returns:     an function that returns an interpolated phase for t in range</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Neuroblox/Neuroblox.jl/blob/c259f9fff45c2b5a7d498165a29697cccabb0ab7/src/blox/ts_outputs.jl#L2-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Neuroblox.phase_sin_blox-Union{Tuple{F}, Tuple{Any, Any, F}} where F" href="#Neuroblox.phase_sin_blox-Union{Tuple{F}, Tuple{Any, Any, F}} where F"><code>Neuroblox.phase_sin_blox</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>phase<em>sin</em>blox is creating a sin with angular frequency ω and variable phase phase<em>inter has the following parameters:     ω: angular frequency     t: time     phase</em>inter: a function that returns phase as a function of time and returns:     the resulting value</p><p>Usage:     phase<em>int = phase</em>inter(0:0.1:50,phase<em>data)     phase</em>out(t) = phase<em>sin</em>blox(0.1,t,phase<em>int)     which is now a function of time and can be used in an input blox     you can also use the dot operator to calculate time-series     signal = phase</em>out.(collect(0:0.01:50))</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Neuroblox/Neuroblox.jl/blob/c259f9fff45c2b5a7d498165a29697cccabb0ab7/src/blox/ts_outputs.jl#L43-L58">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Neuroblox.phaseangle-Tuple{}" href="#Neuroblox.phaseangle-Tuple{}"><code>Neuroblox.phaseangle</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>phaseangle takes in time series data, hilbert transforms it, and estimates the phase angle.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Neuroblox/Neuroblox.jl/blob/c259f9fff45c2b5a7d498165a29697cccabb0ab7/src/utilities/spectral_tools.jl#L55-L57">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Neuroblox.random_initials-Tuple{ODESystem, Any}" href="#Neuroblox.random_initials-Tuple{ODESystem, Any}"><code>Neuroblox.random_initials</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>random_initials creates a vector of random initial conditions for an ODESystem that is composed of a list of blox.  The function finds the initial conditions in the blox and then sets a random value in between range tuple given for that state.</p><p>It has the following inputs:     odesys: ODESystem     blox  : list of blox</p><p>And outputs:     u0 : Float64 vector of initial conditions</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Neuroblox/Neuroblox.jl/blob/c259f9fff45c2b5a7d498165a29697cccabb0ab7/src/Neuroblox.jl#L148-L159">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Neuroblox.sample_affect!-NTuple{4, Any}" href="#Neuroblox.sample_affect!-NTuple{4, Any}"><code>Neuroblox.sample_affect!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Non-symbolic, time-block-based way of `@register_symbolic sample_poisson(λ)`.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Neuroblox/Neuroblox.jl/blob/c259f9fff45c2b5a7d498165a29697cccabb0ab7/src/blox/connections.jl#L879-L881">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Neuroblox.setup_sDCM-NTuple{9, Any}" href="#Neuroblox.setup_sDCM-NTuple{9, Any}"><code>Neuroblox.setup_sDCM</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function setup_sDCM(data, stateevolutionmodel, initcond, csdsetup, priors, hyperpriors, indices)

Interface function to performs variational inference to fit model parameters to empirical cross spectral density.
The current implementation provides a Variational Laplace fit (see function above `variationalbayes`).

Arguments:
- `data`        : dataframe with column names corresponding to the regions of measurement.
- `model`       : MTK model, including state evolution and measurement.
- `initcond`    : dictionary of initial conditions, numerical values for all states
- `csdsetup`    : dictionary of parameters required for the computation of the cross spectral density
-- `dt`         : sampling interval
-- `freq`       : frequencies at which to evaluate the CSD
-- `p`          : order parameter of the multivariate autoregression model
- `priors`      : dataframe of parameters with the following columns:
-- `name`       : corresponds to MTK model name
-- `mean`       : corresponds to prior mean value
-- `variance`   : corresponds to the prior variances
- `hyperpriors` : dataframe of parameters with the following columns:
-- `Πλ_pr`      : prior precision matrix for λ hyperparameter(s)
-- `μλ_pr`      : prior mean(s) for λ hyperparameter(s)
- `indices`  : indices to separate model parameters from other parameters. Needed for the computation of AD gradient.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Neuroblox/Neuroblox.jl/blob/c259f9fff45c2b5a7d498165a29697cccabb0ab7/src/datafitting/spDCM_VL.jl#L379-L401">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Neuroblox.spm_logdet-Tuple{Any}" href="#Neuroblox.spm_logdet-Tuple{Any}"><code>Neuroblox.spm_logdet</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function spm_logdet(M)

SPM12 style implementation of the logarithm of the determinant of a matrix.

Arguments:
- `M`: matrix</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Neuroblox/Neuroblox.jl/blob/c259f9fff45c2b5a7d498165a29697cccabb0ab7/src/datafitting/spDCM_VL.jl#L267-L274">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Neuroblox.system_from_graph" href="#Neuroblox.system_from_graph"><code>Neuroblox.system_from_graph</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">system_from_graph(g::MetaDiGraph, p=Num[]; name, simplify=true, graphdynamics=false, kwargs...)</code></pre><p>Take in a <code>MetaDiGraph</code> <code>g</code> describing a network of neural structures (and optionally a vector of extra parameters <code>p</code>) and construct a <code>System</code> which can be used to construct various <code>Problem</code> types (i.e. <code>ODEProblem</code>) for use with DifferentialEquations.jl solvers.</p><p>If <code>simplify</code> is set to <code>true</code> (the default), then the resulting system will have <code>structural_simplify</code> called on it with any remaining keyword arguments forwared to <code>structural_simplify</code>. That is,</p><pre><code class="nohighlight hljs">@named sys = system_from_graph(g; kwarg1=x, kwarg2=y)</code></pre><p>is equivalent to</p><pre><code class="nohighlight hljs">@named sys = system_from_graph(g; simplify=false)
sys = structural_simplify(sys; kwarg1=x, kwarg2=y)</code></pre><p>See the docstring for <code>structural_simplify</code> for information on which options it supports.</p><p>If <code>graphdynamics=true</code> (defaults to <code>false</code>), the output will be a <code>GraphSystem</code> from <a href="https://github.com/Neuroblox/GraphDynamics.jl">GraphDynamics.jl</a>, and the <code>kwargs</code> will be sent to the <code>GraphDynamics</code> constructor instead of using <a href="https://github.com/SciML/ModelingToolkit.jl/">ModelingToolkit.jl</a>. The GraphDynamics.jl backend is typically significantly faster for large neural systems than the default backend, but is experimental and does not yet support all Neuroblox.jl features. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Neuroblox/Neuroblox.jl/blob/c259f9fff45c2b5a7d498165a29697cccabb0ab7/src/Neurographs.jl#L241-L258">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Neuroblox.vecparam-Tuple{OrderedCollections.OrderedDict}" href="#Neuroblox.vecparam-Tuple{OrderedCollections.OrderedDict}"><code>Neuroblox.vecparam</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">vecparam(param::OrderedDict)

Function to flatten an ordered dictionary of model parameters and return a simple list of parameter values.

Arguments:
- `param`: dictionary of model parameters (may contain numbers and lists of numbers)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Neuroblox/Neuroblox.jl/blob/c259f9fff45c2b5a7d498165a29697cccabb0ab7/src/datafitting/spDCM_VL.jl#L284-L291">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tutorials/spectralDCM/">« Solving Inverse Problems with Spectral Dynamic Causal Modeling</a><a class="docs-footer-nextpage" href="../release_notes/">Release Notes »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Thursday 2 January 2025 20:56">Thursday 2 January 2025</span>. Using Julia version 1.11.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
